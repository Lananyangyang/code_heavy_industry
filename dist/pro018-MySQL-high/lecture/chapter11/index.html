<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>代码重工</title>
    <meta name="generator" content="VuePress 1.9.5">
    
    <meta name="description" content="代码重工">
    
    <link rel="preload" href="/code_heavy_industry/assets/css/0.styles.0861752e.css" as="style"><link rel="preload" href="/code_heavy_industry/assets/js/app.7f9743ec.js" as="script"><link rel="preload" href="/code_heavy_industry/assets/js/3.8b9ff05a.js" as="script"><link rel="preload" href="/code_heavy_industry/assets/js/6.a2844d61.js" as="script"><link rel="prefetch" href="/code_heavy_industry/assets/js/10.9e5dadb0.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/100.8f5a29e9.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/101.29b81378.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/102.5e816f5e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/103.6ea42031.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/104.33375ef0.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/105.69ddeea6.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/106.cd39c41b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/107.e8b4f02e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/108.ee1c335c.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/109.c8cb84a0.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/11.e6a3ed72.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/110.39f9c427.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/111.354f3473.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/112.ec4646d3.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/113.910264b9.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/114.5c0dfaca.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/115.70f2c96d.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/116.7dc4a1d4.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/117.5f825cbf.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/118.16255db4.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/119.645f3801.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/12.4b002a87.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/120.92f46f59.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/121.8cd36cb9.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/122.b5acb330.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/123.8d08e830.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/124.9dbd71d8.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/125.349adb34.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/126.66222420.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/127.b7662772.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/128.722531c2.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/129.1e0d1a2e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/13.74c96d0e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/130.67f8f186.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/131.bb7dac29.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/132.5d7dbd47.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/133.c1ed5c21.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/134.ec6f3e21.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/135.637752c1.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/136.6248ba38.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/137.eeefbd96.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/138.6abcb2d5.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/139.fc02aa4c.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/14.ec99cbbf.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/140.b9654c0e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/141.89c71ef2.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/142.9032e9e5.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/143.517a87d6.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/144.a403ea4e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/145.9d73f4c6.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/146.afbfebfc.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/147.5a3f3acd.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/148.1adfc434.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/149.58235fcc.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/15.bfc7842b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/150.98858ebf.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/151.21c2d28a.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/152.d574dde5.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/153.665d1243.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/154.4b9e89e5.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/155.0192c138.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/156.3ccf7197.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/157.24d6e0a0.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/158.31004020.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/159.6ac89600.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/16.a002f9ac.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/160.b43b1c12.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/161.81adbc9f.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/162.c9328568.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/163.8018d26a.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/164.9d584fda.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/165.4f1ef366.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/166.970c2bdc.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/167.b41b373b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/168.d0f88e99.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/169.7f51840a.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/17.694c7afb.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/170.4a219c85.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/171.e6a9e9fc.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/172.b77e8d14.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/173.76811cdc.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/174.62f24f02.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/175.d4368038.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/176.b6ba995f.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/177.1ec3f302.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/178.67bf52a8.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/179.e24a1913.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/18.ccd0c6b7.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/180.31944291.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/181.2cbc666c.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/182.2131d933.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/183.dd500e6a.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/184.eb13ef69.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/185.c0107b42.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/186.18b6c846.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/187.bea2dbc4.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/188.5002b514.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/189.965e1080.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/19.b4a3c7eb.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/190.96e366e1.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/191.3209da50.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/192.3bfcd2bc.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/193.5929a76d.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/194.95f2268b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/195.6621f5a1.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/196.08bb6cb4.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/197.94f9e4d3.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/198.0d674002.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/199.df138110.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/2.129db156.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/20.ed0a3a55.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/200.9f0db46f.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/201.887eac17.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/202.02d0fa9a.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/203.1800408e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/204.00fcbffe.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/205.0d37d909.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/206.1374da01.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/207.608d17d9.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/208.6d48aa1a.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/209.e632e298.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/21.e0d81486.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/210.8b432cac.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/211.5525ff2b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/212.d827048f.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/213.833f5502.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/214.7309821a.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/215.440a1d14.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/216.4d559d3f.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/217.a5d29a84.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/218.5ffcc692.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/219.51275dd9.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/22.3a6d10a4.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/220.3e470bea.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/221.8f66424a.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/222.61e08933.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/223.4d4eed3c.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/224.fafa0cb2.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/225.08621cda.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/226.67d06707.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/227.fff148b6.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/228.6115ba34.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/229.7108649d.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/23.3676e255.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/230.aaf158d0.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/231.390b673d.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/232.a0fec606.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/233.7ac75853.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/234.807230c5.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/235.bc4a3c30.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/236.7b7ca7dc.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/237.34e77739.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/238.97e4dc76.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/239.f47a1aa0.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/24.da85bba8.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/240.5954c700.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/241.e78e9b0b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/242.aa89cde1.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/243.390adf78.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/244.1c3ae714.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/245.61c4fb0f.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/246.ea68e953.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/247.c2a5064f.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/248.50298122.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/249.ee170a13.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/25.c2d8f82b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/250.0c6b5d86.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/251.7e67787c.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/252.da32fac8.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/253.ab1ef7f2.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/254.1f5b6404.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/255.fae2ce2b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/256.d90e59b2.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/257.7be8b004.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/258.280278f8.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/259.2d310afa.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/26.aff9b419.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/260.432daeb4.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/261.c675a6cb.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/262.9e56723c.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/263.863cd481.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/264.d970b7a6.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/265.dc0580f4.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/266.28bc534e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/267.148efd3e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/268.7f4c1c9e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/269.e9311261.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/27.f2177d6f.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/270.b0f4e7d6.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/271.63e1a0f5.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/272.9ca5637f.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/273.fec2c633.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/274.5debbcfc.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/275.142659a4.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/276.f82f773d.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/277.4bde6524.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/278.4b4f91be.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/279.167cba7d.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/28.7b0964fe.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/280.8d8eca1a.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/281.6921b8fa.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/282.718c4b42.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/283.e70ccd4e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/284.a2388dae.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/285.632ad773.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/286.a7f067df.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/287.7290d067.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/288.27e4837e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/289.67cba7ad.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/29.24135970.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/290.00f158e9.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/291.ead13905.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/292.742041c1.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/293.5f495e55.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/294.e598921b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/295.459c5239.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/296.ad33a6cf.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/297.ff5c36e6.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/298.754014d0.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/299.025d3f45.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/30.faabd25e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/300.6f145dd5.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/301.e116e828.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/302.37998d18.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/303.05138d82.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/304.09e1d3c1.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/305.a89a2db8.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/306.124d889b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/307.992ae393.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/308.7ac728a3.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/309.c6a04bbc.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/31.08851934.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/310.2eed785e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/311.1c29f6fe.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/312.7af787d0.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/313.c74afbf6.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/314.910e5e39.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/315.c5dd28c4.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/316.10c96311.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/317.9278dbf1.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/318.8c689e82.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/319.b5278067.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/32.14a30902.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/320.3055dacf.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/321.cf67fd21.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/322.70a43dba.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/323.b70b9462.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/324.bd4961fe.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/325.adf52175.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/326.1c9dd097.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/327.dee57352.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/328.db062429.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/329.1d6f7138.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/33.186f94df.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/330.5ac388cf.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/331.1630f38d.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/332.1ad748a0.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/333.0580d2af.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/334.8de2805e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/335.087ded33.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/336.e6a6dc2f.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/337.d2aa5bee.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/338.4738411c.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/339.f356fab1.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/34.c11b1963.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/340.076ba517.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/341.104fb5b4.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/342.037a6ee6.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/343.6b22bb91.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/344.090df1be.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/345.26c99d9b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/346.7ebc1f94.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/347.fa1b3c59.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/348.430d5828.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/349.fdcd53c7.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/35.c1c08059.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/350.5e074b5d.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/351.b8b43486.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/352.d82bdce0.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/353.b2e42997.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/354.0aa2342b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/355.5b642322.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/356.edd090a6.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/357.2cf7bdbe.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/358.d8305bc3.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/359.e47011d1.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/36.e1e02bf6.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/360.0bebcdca.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/361.b1fbab0f.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/362.bc493a79.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/363.f70ab9b9.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/364.62727a70.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/365.07f99f29.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/366.8874a46d.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/367.9e5c13b0.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/368.df13679b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/369.f33c6643.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/37.5f23a57a.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/370.6c458677.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/371.55a6677d.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/372.eb93a3c7.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/373.eb1982f1.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/374.cc726625.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/375.383c2138.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/376.3cb5c03f.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/377.897e3235.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/378.dd9b223d.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/379.2bf2e697.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/38.7b28ea8e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/380.fb367166.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/381.cafec0bd.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/382.9e5910d7.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/383.0ad358fc.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/384.6d276764.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/385.6dbb58e9.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/386.b0957b1c.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/387.60c7a690.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/388.c5c5fcdf.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/389.0a1ddccc.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/39.bbf3c80b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/390.d512318f.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/391.1d979484.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/392.a8098ea7.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/393.92777103.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/394.cc392b77.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/395.ca950308.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/396.9fb54919.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/397.2115f471.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/398.e75bec64.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/399.8f70e103.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/4.5cf1b41b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/40.04aab78e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/400.7194da3d.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/401.47c8656d.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/402.8f2cc056.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/403.3487724c.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/404.1cb4a173.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/405.95a9653b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/406.33040c0e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/407.26cc86ea.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/408.3dbc0630.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/409.040263ca.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/41.5c82fdd4.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/410.407f5477.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/411.ffa33364.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/412.399b4591.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/413.242f9523.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/414.af4bd968.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/415.38b32adf.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/416.c9507f66.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/417.8a9bd07e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/418.a027c70d.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/419.4f62e15d.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/42.19936128.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/420.964996c2.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/421.edf687b8.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/422.d3ac064e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/423.705e2012.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/424.43c391a8.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/425.2cbc0873.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/426.be7995e7.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/427.3ea0ae6d.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/428.e838d623.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/429.b4a10e72.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/43.73f8c989.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/430.35b053da.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/431.3aa1727c.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/432.39b1e4de.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/433.532f965e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/434.5c52c468.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/435.ea8b2aa9.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/436.7457967e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/437.060b18e8.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/438.4e1debe0.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/439.3aadb3ff.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/44.bd593dce.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/440.29ec178e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/441.82cc8171.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/442.2b62c95f.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/443.b8539c88.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/444.80de3143.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/445.1e7c5248.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/446.dd999a03.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/447.cf6393db.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/448.61f15a2c.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/449.bdd233a5.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/45.eba268e5.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/450.70d4052f.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/451.0548ad51.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/452.87ba94fd.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/453.62080822.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/454.d8272209.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/455.1a9bbb51.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/456.c651e7d6.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/457.59989bb8.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/458.dd1f49dd.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/459.44cf5aa7.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/46.29daccff.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/460.df72f5a0.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/461.659c2a4d.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/462.19c318e7.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/463.d3fa33bf.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/464.f0da48e9.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/465.ad8862f4.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/466.f8da7902.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/467.fffecc84.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/468.45314cda.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/469.f9235e76.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/47.69c6b4fc.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/470.455fd5b9.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/471.723149dd.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/472.7eb4139d.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/473.fa024c6e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/474.5d322409.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/475.b37f50d8.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/476.8d4131cf.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/477.4c8b0581.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/478.51de5ac1.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/479.a8b0b03f.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/48.ccbc3293.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/480.918e6c46.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/481.dbfa2cc3.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/482.3f21e56a.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/483.e9511395.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/484.36d5954c.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/485.d233fd15.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/486.fdcbd2d2.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/487.90c72c1f.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/488.8af31c6d.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/489.a0e922b1.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/49.94d657f1.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/490.331f25e7.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/491.7feab332.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/492.58a390e0.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/493.0e64060b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/494.afb42bb0.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/495.c1b1c79b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/496.c5279f58.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/497.9f3e34c4.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/498.41bc4c1c.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/499.0429eae8.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/5.2f7c664b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/50.fa541c18.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/500.67c562b7.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/501.81ee2f98.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/502.f98ae9ce.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/503.4dfe2b7a.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/504.28ab0915.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/505.a1499668.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/506.bec95a7e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/507.3d128d04.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/508.33f0c4a1.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/509.10ab2d38.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/51.1e36d22c.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/510.e4c87ac3.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/511.4b4b13d4.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/512.0dc34ab3.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/513.57d1e893.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/514.ba56df49.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/515.910ee6e4.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/516.e4b97c80.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/517.6f90fa5b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/518.17b7bc44.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/519.9ad8c481.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/52.c16a9674.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/520.af930f6b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/521.354155d5.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/522.442d70c1.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/523.d8bff54e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/524.b22cfed2.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/525.8c36171c.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/526.2b463e2f.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/527.8eee1f24.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/528.d31600ac.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/529.3e1c5999.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/53.a32cc8f0.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/530.0ea0cb20.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/531.4acc52ca.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/532.857ba260.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/533.fae0ac05.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/534.0650eea7.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/535.78687b4d.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/536.e6745eb2.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/537.43ef5872.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/538.6a590a6e.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/539.9ee0974a.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/54.e8c75b23.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/540.8855f112.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/541.6a4aa775.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/542.f4d41a86.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/543.501e0818.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/544.99919b53.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/545.f9039617.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/546.e837db30.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/547.47299958.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/548.770ec798.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/549.34a32213.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/55.23970729.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/550.2822e138.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/551.087de360.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/552.356520ad.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/553.4017fb93.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/554.c03f2769.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/555.fd2ceeb8.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/556.ffbcf214.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/557.8d8b9998.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/558.e6d3b207.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/559.135a8890.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/56.67bff8e6.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/560.abb49c8f.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/561.704a7719.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/562.341b75d3.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/57.c75372fd.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/58.c97a9775.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/59.b0494aab.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/60.70a5f114.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/61.bf92aa4f.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/62.ca050126.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/63.0118eea3.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/64.1aed5055.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/65.23375af2.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/66.3a6407ad.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/67.e210db66.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/68.b262f90b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/69.96c02b28.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/7.74331897.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/70.647d344a.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/71.06385250.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/72.d1e16ae2.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/73.fb4e7925.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/74.0646974c.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/75.03dc9b20.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/76.58565ae1.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/77.b359fd2f.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/78.f1ba342d.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/79.ef038b20.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/8.0babf323.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/80.a1e28eb8.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/81.133ef25b.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/82.eb6f5189.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/83.46a230c8.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/84.6bd070b7.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/85.cf9cd822.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/86.70ec64f4.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/87.49a6c967.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/88.886abb03.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/89.acc26890.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/9.fb0e2768.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/90.8ef8196c.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/91.cc75cb06.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/92.a6f82b8a.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/93.6dde4f94.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/94.e3201d0c.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/95.2d7a4daf.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/96.37527b62.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/97.dee2460a.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/98.5acf9b46.js"><link rel="prefetch" href="/code_heavy_industry/assets/js/99.fdab0d93.js">
    <link rel="stylesheet" href="/code_heavy_industry/assets/css/0.styles.0861752e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/code_heavy_industry/" class="home-link router-link-active"><!----> <span class="site-name">代码重工</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><p></p><div class="table-of-contents"><ul><li><a href="#_1简介">①简介</a></li><li><a href="#_2水平切分">②水平切分</a></li><li><a href="#_3垂直切分">③垂直切分</a></li><li><a href="#_4存在的问题">④存在的问题</a></li><li><a href="#_1mycat简介">①Mycat简介</a></li><li><a href="#_2mycat安装">②Mycat安装</a></li><li><a href="#_3mycat核心概念">③Mycat核心概念</a></li><li><a href="#_1环境准备">①环境准备</a></li><li><a href="#_2通过mycat访问数据库">②通过Mycat访问数据库</a><ul><li><a href="#_1-server-xml配置">[1]server.xml配置</a></li><li><a href="#_2-schema-xml配置">[2]schema.xml配置</a></li><li><a href="#_3-设置启动程序的-jvm-参数">[3]设置启动程序的 JVM 参数</a></li><li><a href="#_4-访问测试">[4]访问测试</a></li></ul></li><li><a href="#_3数据分片">③数据分片</a><ul><li><a href="#_1-取模分片">[1]取模分片</a></li><li><a href="#_2-全局id分片">[2]全局id分片</a></li><li><a href="#_3-枚举分片">[3]枚举分片</a></li><li><a href="#_4-固定hash分片">[4]固定hash分片</a></li><li><a href="#_5-固定范围分片">[5]固定范围分片</a></li><li><a href="#_6-取模范围分片">[6]取模范围分片</a></li><li><a href="#_7-字符串hash分片">[7]字符串hash分片</a></li><li><a href="#_8-一致性hash">[8]一致性hash</a></li><li><a href="#_9-时间分片">[9]时间分片</a></li></ul></li><li><a href="#_4跨库join">④跨库join</a><ul><li><a href="#_1-全局表">[1]全局表</a></li><li><a href="#_2-er表">[2]ER表</a></li></ul></li></ul></div><p></p> <h1 id="第十一章-mycat"><a href="#第十一章-mycat" class="header-anchor">#</a> 第十一章 MyCat</h1> <h1 id="_1-数据分片"><a href="#_1-数据分片" class="header-anchor">#</a> 1 数据分片</h1> <h2 id="_1简介"><a href="#_1简介" class="header-anchor">#</a> ①简介</h2> <p>当前微服务架构非常流行，很多都会采用微服务架构对其系统进行拆分。 而虽然产生了多个微服务，但因为其用户量和数据量的问题，很有可能仍然使用的是同一个数据库。但是随着用户量和数据量增加，就会出现很多影响数据库性能的因素，如：数据存储量、IO瓶颈、访问量瓶颈等。此时就需要将数据进行拆分，从一个库拆分成多个库。</p> <p><img src="/code_heavy_industry/assets/img/image-20200601232224434.0c0be98c.png" alt=""></p> <h2 id="_2水平切分"><a href="#_2水平切分" class="header-anchor">#</a> ②水平切分</h2> <p><img src="data:image/png;base64,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" alt="images"></p> <p>为了解决垂直拆分出现的问题，可以使用水平拆分继续横向扩展，首先，可以如果<strong>当前数据库的容量没有问题</strong>的话，可以对读写极其频繁且数据量超大的表进行<strong>分表</strong>操作。由一张表拆分出多张表。</p> <p>在一个库中，拆分出多张表，每张表存储不同的数据，这样对于其操作效率会有明显的提升。而且因为处于同一个库中，也不会出现分布式事务的问题。</p> <p><img src="/code_heavy_industry/assets/img/image-20200602001628392.2d2aab1d.png" alt=""></p> <p>而拆分出多张表后，如果当前数据库的容量已经不够了，但是还要继续拆分的话，就可以进行<strong>分库</strong>操作，产生多个数据库，然后在扩展出的数据库中继续扩展表。</p> <p><img src="/code_heavy_industry/assets/img/image-20200602002017703.a5ca36b8.png" alt=""></p> <p><strong>优点：</strong></p> <ul><li>尽量的避免了跨库join（连接另外一个数据库的表执行关联查询）操作</li> <li>不会存在超大型表的性能瓶颈问题</li> <li>事务处理相对简单</li> <li>只要拆分规则定义好，很难出现扩展性的限制</li></ul> <p><strong>缺点：</strong></p> <ul><li>拆分规则不好明确，规则一定会和业务挂钩，如根据id、根据时间等</li> <li>不好明确数据位置，难以进行维护</li> <li>多数据源管理难度加大，代码复杂度增加</li> <li>也会存在分布式事务问题</li> <li>数据库维护成本增加</li></ul> <h2 id="_3垂直切分"><a href="#_3垂直切分" class="header-anchor">#</a> ③垂直切分</h2> <p>垂直拆分是按照业务将表进行分类并分布到不同的数据节点上。在初始进行数据拆分时，使用垂直拆分是非常直观的一种方式。</p> <p><img src="/code_heavy_industry/assets/img/image-20200601235540364.d74bb0de.png" alt=""></p> <p><strong>优点：</strong></p> <ul><li>拆分规格明确，按照不同的功能模块或服务分配不同的数据库</li> <li>数据维护与定位简单</li></ul> <p><strong>缺点：</strong></p> <ul><li>对于读写极其频繁且数据量超大的表，仍然存在存储与性能瓶颈。简单的索引此时已经无法解决问题</li> <li>会出现跨库join</li> <li>需要对代码进行重构，修改原有的事务操作</li> <li>某个表数据量达到一定程度后扩展起来较为困难</li></ul> <h2 id="_4存在的问题"><a href="#_4存在的问题" class="header-anchor">#</a> ④存在的问题</h2> <p><strong>数据切分带来的问题:</strong></p> <ul><li>产生引入分布式事务的问题</li> <li>跨节点 Join 的问题</li> <li>跨节点合并排序分页问题</li></ul> <p>例如:</p> <ul><li>按照用户ID求模，将数据分散到不同的数据库，具有相同数据用户的数据都被分散到一个库中</li> <li>按照日期，将不同月甚至日的数据分散到不同的库中</li> <li>按照某个特定的字段求模，或者根据特定范围段分散到不同的库中</li></ul> <h1 id="_2-mycat介绍"><a href="#_2-mycat介绍" class="header-anchor">#</a> 2 Mycat介绍</h1> <p><img src="/code_heavy_industry/assets/img/img002.0dc3cc1b.png" alt="images"></p> <h2 id="_1mycat简介"><a href="#_1mycat简介" class="header-anchor">#</a> ①Mycat简介</h2> <p>当对数据拆分后会产生诸多的问题，对于这些问题的解决，可以借助于数据库中间件来进行解决，现在时下比较流行的是使用Mycat。</p> <p>Mycat是一款数据库中间件，对于应用程序来说是完全透明化的，不管底层的数据如何拆分，应用只需要连接Mycat即可完成对数据的操作。同时它还支持MySQL、SQL Server、Oracle、DB2、PostgreSQL等主流数据库。但是Mycat不会进行数据存储，它只是用于数据的路由。</p> <p>其底层是基于拦截思想实现，其会拦截用户发送过来的SQL语句，首先对SQL语句做了一些特定的分析：如分片分析、路由分析、读写分离分析、缓存分析等，然后将此SQL发往后端的真实数据库，并将返回的结果做适当的处理，最终再返回给用户。</p> <p><img src="/code_heavy_industry/assets/img/image-20200602235241816.1fb196e1.png" alt=""></p> <p>Mycat的特性如下:</p> <ul><li>支持SQL92标准</li> <li>遵守Mysql原生协议，跨语言，跨平台，跨数据库的通用中间件代理</li> <li>基于心跳的自动故障切换，支持读写分离，支持MySQL主从，以及galera cluster集群</li> <li>支持Galera for MySQL集群，Percona Cluster或者MariaDB cluster</li> <li>基于Nio实现，有效管理线程，高并发问题</li> <li>支持数据的多片自动路由与聚合，支持sum,count,max等常用的聚合函数</li> <li>支持单库内部任意join，支持跨库2表join</li> <li>支持通过全局表，ER关系的分片策略，实现了高效的多表join查询</li> <li>支持多租户方案</li> <li>支持分布式事务</li> <li>支持全局序列号，解决分布式下的主键生成问题</li> <li>分片规则丰富，插件化开发，易于扩展</li> <li>强大的web，命令行监控</li> <li>支持前端作为mysq通用代理，后端JDBC方式支持Oracle、DB2、SQL Server 、 mongodb</li> <li>支持密码加密</li> <li>支持服务降级</li> <li>支持IP白名单</li> <li>支持SQL黑名单、sql注入攻击拦截</li> <li>支持分表(1.6以后版本)</li> <li>集群基于ZooKeeper管理，在线升级，扩容，智能优化，大数据处理（2.0以后版本）</li></ul> <h2 id="_2mycat安装"><a href="#_2mycat安装" class="header-anchor">#</a> ②Mycat安装</h2> <p><strong>本质</strong>：MyCat 的本质是上一个 Java 写的 Maven 工程。</p> <p>**源码下载：**https://codeload.github.com/MyCATApache/Mycat-Server/zip/Mycat-server-1675-release</p> <p><strong>官网:</strong> http://www.mycat.org.cn/</p> <p><strong>默认端口：8066</strong></p> <p><strong>配置启动 JVM 参数：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#环境变量
-DMYCAT_HOME=D:\workspace\Mycat-Server-Mycat-server-1675-release\src\main

#设置堆外内存大小:当使用mycat对非分片查询时，会把所有的数据查询出来，然后把这部分数据放在堆外内存中
-XX:MaxDirectMemorySize=512M 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>在Mycat有核心三个配置文件，分别为：<strong>sever.xml、schema.xml、rule.xml</strong></p> <ul><li><strong>sever.xml</strong>：是Mycat服务器参数调整和用户授权的配置文件</li> <li><strong>schema.xml</strong>：是逻辑库定义和表以及分片定义的配置文件</li> <li><strong>rule.xml</strong>：是分片规则的配置文件，分片规则的具体一些参数信息单独存放为文件，也在这个目录下，配置文件修改需要重启</li></ul> <h2 id="_3mycat核心概念"><a href="#_3mycat核心概念" class="header-anchor">#</a> ③Mycat核心概念</h2> <ul><li><strong>逻辑库</strong>：Mycat中的虚拟数据库。对应实际数据库的概念。在没有使用mycat时，应用需要确定当前连接的数据库等信息，那么当使用mycat后，也需要先虚拟一个数据库，用于应用的连接。</li> <li><strong>逻辑表</strong>：mycat中的虚拟数据表。对应时间数据库中数据表的概念。</li> <li><strong>非分片表</strong>：没有进行数据切分的表。</li> <li><strong>分片表</strong>：已经被数据拆分的表，每个分片表中都有原有数据表的一部分数据。多张分片表可以构成一个完整数据表。</li> <li><strong>ER表</strong>：子表的记录与所关联的父表记录存放在同一个数据分片上，即子表依赖于父表，通过表分组（Table Group）保证数据Join不会跨库操作。表分组（Table Group）是解决跨分片数据join的一种很好的思路，也是数据切分规划的重要一条规则</li> <li><strong>全局表</strong>：可以理解为是一张数据冗余表，如状态表，每一个数据分片节点又保存了一份状态表数据。数据冗余是解决跨分片数据join的一种很好的思路，也是数据切分规划的另外一条重要规则。</li> <li><strong>分片节点（dataNode）</strong>：数据切分后，每一个数据分片表所在的数据库就是分片节点。</li> <li><strong>节点主机（dataHost）</strong>：数据切分后，每个分片节点（dataNode）不一定都会独占一台机器，同一机器上面可以有多个分片数据库，这样一个或多个分片节点（dataNode）所在的机器就是节点主机（dataHost）,为了规避单节点主机并发数限制，尽量将读写压力高的分片节点（dataNode）均衡的放在不同的节点主机（dataHost）。</li> <li><strong>分片规则（rule）</strong>：按照某种业务规则把数据分到某个分片的规则就是分片规则。</li> <li><strong>全局序列号（sequence）</strong>：也可以理解为分布式id。数据切分后，原有的关系数据库中的主键约束在分布式条件下将无法使用，因此需要引入外部机制保证数据唯一性标识，这种保证全局性的数据唯一标识的机制就是全局序列号（sequence），如UUID、雪花算法等。</li></ul> <h1 id="_3-mycat使用"><a href="#_3-mycat使用" class="header-anchor">#</a> 3 Mycat使用</h1> <h2 id="_1环境准备"><a href="#_1环境准备" class="header-anchor">#</a> ①环境准备</h2> <p>在server.xml 文件中的system标签下配置所有的参数，全部为环境参数，可以根据当前需要进行开启和配置，如：设置mycat连接端口号</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>serverPort<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>8066<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/code_heavy_industry/assets/img/image-20200603010530819.23aeea66.png" alt=""></p> <h2 id="_2通过mycat访问数据库"><a href="#_2通过mycat访问数据库" class="header-anchor">#</a> ②通过Mycat访问数据库</h2> <h3 id="_1-server-xml配置"><a href="#_1-server-xml配置" class="header-anchor">#</a> [1]server.xml配置</h3> <p><img src="/code_heavy_industry/assets/img/img003.5ab50d0b.png" alt="images"></p> <p>应用连接mycat的话，也需要设置用户名、密码、被连接数据库信息，要配置这些信息的话，可以修改server.xml，在其内部添加内容如下：</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!--配置自定义用户信息--&gt;</span>
<span class="token comment">&lt;!--连接用户名--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mycat<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--连接密码--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>mycat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--创建虚拟数据库--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>schemas<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>userDB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--指定该库是否只读--&gt;</span>
    <span class="token comment">&lt;!--&lt;property name=&quot;readOnly&quot;&gt;true&lt;/property&gt;--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>user</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_2-schema-xml配置"><a href="#_2-schema-xml配置" class="header-anchor">#</a> [2]schema.xml配置</h3> <p><img src="/code_heavy_industry/assets/img/img004.d9a483b2.png" alt="images"></p> <p>当配置了一个虚拟数据库后，还需要修改schema.xml，对虚拟库进行详细配置</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mycat:schema</span> <span class="token name">SYSTEM</span> <span class="token string">&quot;schema.dtd&quot;</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mycat:</span>schema</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>mycat</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://io.mycat/<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

	<span class="token comment">&lt;!--配置虚拟数据库--&gt;</span>
	<span class="token comment">&lt;!--name：虚拟逻辑数据库名称，对应server.xml中的schemas属性值--&gt;</span>
	<span class="token comment">&lt;!--dataNode：逻辑库中逻辑表的默认数据节点--&gt;</span>
	<span class="token comment">&lt;!--sqlMaxLimit：类似于SQL上添加limit，如schema为非分片库，则该属性无效--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schema</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userDB<span class="token punctuation">&quot;</span></span> <span class="token attr-name">checkSQLschema</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dataNode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>localdn<span class="token punctuation">&quot;</span></span> <span class="token attr-name">sqlMaxLimit</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>500<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!--配置虚拟逻辑表--&gt;</span>
		<span class="token comment">&lt;!--name：逻辑表名称，必须唯一--&gt;</span>
		<span class="token comment">&lt;!--dataNode：逻辑表所处的数据节点，值必须与dataNode标签中的name属性对应。如果值过多可以用$连接，如：dn$1-99,dn$200-400--&gt;</span>
		<span class="token comment">&lt;!--primaryKey：逻辑表对应的真实表的主键id的字段名--&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tb_user<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dataNode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>localdn<span class="token punctuation">&quot;</span></span> <span class="token attr-name">primaryKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user_id<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schema</span><span class="token punctuation">&gt;</span></span>

	<span class="token comment">&lt;!--配置dataNode信息--&gt;</span>
	<span class="token comment">&lt;!--name：当前datanode名称--&gt;</span>
	<span class="token comment">&lt;!--dataHost：分片节点所处的节点主机，该值必须与dataHost标签中的name属性对应--&gt;</span>
	<span class="token comment">&lt;!--database：当前数据节点所对应的实际物理数据库--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataNode</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>localdn<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dataHost</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>localdh<span class="token punctuation">&quot;</span></span> <span class="token attr-name">database</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

	<span class="token comment">&lt;!--配置节点主机--&gt;</span>
	<span class="token comment">&lt;!--balance：用于进行读操作指向，有三个值可选
		0：所有读操作都发送到当前可用的writeHost上
		1：所有读操作都随机的发送到readHost上
		2：所有读操作都随机发送在writeHost与readHost上
	--&gt;</span>
	<span class="token comment">&lt;!--maxCon：指定每个读写实例连接池的最大连接。也就是说，标签内嵌套的writeHost、readHost标签都会使用这个属性的值来实例化出连接池的最大连接数--&gt;</span>
	<span class="token comment">&lt;!--minCon：指定每个读写实例连接池的最小连接，初始化连接池的大小--&gt;</span>
	<span class="token comment">&lt;!--name：当前节点主机名称，不允许出现重复--&gt;</span>
	<span class="token comment">&lt;!--dbType：当时使用的数据库类型--&gt;</span>
	<span class="token comment">&lt;!--dbDriver：当前使用的数据库驱动--&gt;</span>
	<span class="token comment">&lt;!--writeType：用于写操作指向，有三个值可选
		0：所有写操作都发送到可用的writeHost上
		1：所有写操作都随机发送到readHost上
		2：所有写操作都随机发送在writeHost与readHost上
	--&gt;</span>
	<span class="token comment">&lt;!--readHost是从属于writeHost的，即意味着它从那个writeHost获取同步数据。
		因此，当它所属的writeHost宕机了，则它也不会再参与到读写分离中来，即“不工作了”。这是因为此时，它的数据已经“不可靠”了。
		基于这个考虑，目前mycat 1.3和1.4版本中，若想支持MySQL一主一从的标准配置，并且在主节点宕机的情况下，从节点还能读取数据。
		则需要在Mycat里配置为两个writeHost并设置banlance=1。”--&gt;</span>
	<span class="token comment">&lt;!--switchType：设置节点切换操作，有三个值可选
		-1：不自动切换
		1：自动切换，默认值
		2：基于mysql主从同步的状态决定是否切换
	--&gt;</span>
	<span class="token comment">&lt;!--slaveThreshold：主从同步状态决定是否切换，延迟超过该值就不切换--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataHost</span> <span class="token attr-name">balance</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">maxCon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">minCon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>localdh<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dbType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mysql<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dbDriver</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jdbc<span class="token punctuation">&quot;</span></span> <span class="token attr-name">writeType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">switchType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">slaveThreshold</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1000<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!--查询心跳--&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>heartbeat</span><span class="token punctuation">&gt;</span></span>select user()<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>heartbeat</span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!--配置写节点实际物理数据库信息--&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>writeHost</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jdbc:mysql://localhost:3306<span class="token punctuation">&quot;</span></span> <span class="token attr-name">host</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>host1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">password</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span> <span class="token attr-name">user</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>writeHost</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dataHost</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">mycat:</span>schema</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><h3 id="_3-设置启动程序的-jvm-参数"><a href="#_3-设置启动程序的-jvm-参数" class="header-anchor">#</a> [3]设置启动程序的 JVM 参数</h3> <ul><li>先找到启动类：</li></ul> <p><img src="data:image/png;base64,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" alt="images"></p> <ul><li>给 main() 方法设置 JVM 参数</li></ul> <p><img src="/code_heavy_industry/assets/img/img006.3826ea99.png" alt="images"></p> <p><img src="/code_heavy_industry/assets/img/img007.f1a52e93.png" alt="images"></p> <h3 id="_4-访问测试"><a href="#_4-访问测试" class="header-anchor">#</a> [4]访问测试</h3> <p>通过navicat创建本地数据库连接并创建对应数据库，同时创建mycat连接。 在mycat连接中操作表，添加数据，可以发现，本地数据库中同步的也新增了对应的数据。</p> <p><img src="/code_heavy_industry/assets/img/img008.02f6567b.png" alt="images"></p> <h2 id="_3数据分片"><a href="#_3数据分片" class="header-anchor">#</a> ③数据分片</h2> <p>数据分片：制定并应用常规客户端通过 MyCat 操作物理库、物理表时，数据分流的规则。</p> <h3 id="_1-取模分片"><a href="#_1-取模分片" class="header-anchor">#</a> [1]取模分片</h3> <p><img src="/code_heavy_industry/assets/img/img009.a848a8e9.png" alt="images"></p> <p>根据 id 值进行模运算，然后根据取模的计算结果决定数据分流后存入的目标物理表。</p> <p>当一个数据表中的数据量非常大时，就需要考虑对表内数据进行分片，拆分的规则有很多种，比较简单的一种就是，通过对id进行取模，完成数据分片。</p> <ol><li><strong>修改schema.xml</strong></li></ol> <p>table标签新增属性：subTables、rule</p> <ul><li>subTables 属性：用来指定所有物理表，这里要求按照物理表的真实名称来配置。
<ul><li>直接写：t_user</li> <li>多个值用逗号分开：t_user1,t_user2</li> <li>使用正则表达式：t_user$1-5,t_user$7-10</li></ul></li> <li>rule 属性：指定一个具体的数据分片规则。规则的名称可以在 rule.xml 配置文件中找到。</li></ul> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mycat:schema</span> <span class="token name">SYSTEM</span> <span class="token string">&quot;schema.dtd&quot;</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mycat:</span>schema</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>mycat</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://io.mycat/<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

	<span class="token comment">&lt;!--配置虚拟数据库--&gt;</span>
	<span class="token comment">&lt;!--name：虚拟逻辑数据库名称，对应server.xml中的schemas属性值--&gt;</span>
	<span class="token comment">&lt;!--dataNode：逻辑库中逻辑表的默认数据节点--&gt;</span>
	<span class="token comment">&lt;!--sqlMaxLimit：类似于SQL上添加limit，如schema为非分片库，则该属性无效--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schema</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userDB<span class="token punctuation">&quot;</span></span> <span class="token attr-name">checkSQLschema</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dataNode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>localdn<span class="token punctuation">&quot;</span></span> <span class="token attr-name">sqlMaxLimit</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>500<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!--配置虚拟逻辑表--&gt;</span>
		<span class="token comment">&lt;!--name：逻辑表名称，必须唯一--&gt;</span>
		<span class="token comment">&lt;!--dataNode：逻辑表所处的数据节点，值必须与dataNode标签中的name属性对应。如果值过多可以用$连接，如：dn$1-99,dn$200-400--&gt;</span>
		<span class="token comment">&lt;!--primaryKey：逻辑表对应的真实表的主键id的字段名--&gt;</span>
		<span class="token comment">&lt;!--subTables：分表的名称。可以存在多个，tb_user1,tb_user2,tb_user3。如果分表较多，可以通过$连接：tb_user$1-3--&gt;</span>
		<span class="token comment">&lt;!--rule：分片规则，对应rule.xml中配置--&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tb_user<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dataNode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>localdn<span class="token punctuation">&quot;</span></span> <span class="token attr-name">primaryKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user_id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">subTables</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tb_user$1-3<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rule</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mod-long<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schema</span><span class="token punctuation">&gt;</span></span>

	<span class="token comment">&lt;!--配置dataNode信息--&gt;</span>
	<span class="token comment">&lt;!--name：当前datanode名称--&gt;</span>
	<span class="token comment">&lt;!--dataHost：分片节点所处的节点主机，该值必须与dataHost标签中的name属性对应--&gt;</span>
	<span class="token comment">&lt;!--database：当前数据节点所对应的实际物理数据库--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataNode</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>localdn<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dataHost</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>localdh<span class="token punctuation">&quot;</span></span> <span class="token attr-name">database</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

	<span class="token comment">&lt;!--配置节点主机--&gt;</span>
	<span class="token comment">&lt;!--balance：用于进行读操作指向，有三个值可选
		0：所有读操作都发送到当前可用的writeHost上
		1：所有读操作都随机的发送到readHost上
		2：所有读操作都随机发送在writeHost与readHost上
	--&gt;</span>
	<span class="token comment">&lt;!--maxCon：指定每个读写实例连接池的最大连接。也就是说，标签内嵌套的writeHost、readHost标签都会使用这个属性的值来实例化出连接池的最大连接数--&gt;</span>
	<span class="token comment">&lt;!--minCon：指定每个读写实例连接池的最小连接，初始化连接池的大小--&gt;</span>
	<span class="token comment">&lt;!--name：当前节点主机名称，不允许出现重复--&gt;</span>
	<span class="token comment">&lt;!--dbType：当时使用的数据库类型--&gt;</span>
	<span class="token comment">&lt;!--dbDriver：当前使用的数据库驱动--&gt;</span>
	<span class="token comment">&lt;!--writeType：用于写操作指向，有三个值可选
		0：所有写操作都发送到可用的writeHost上
		1：所有写操作都随机发送到readHost上
		2：所有写操作都随机发送在writeHost与readHost上
	--&gt;</span>
	<span class="token comment">&lt;!--readHost是从属于writeHost的，即意味着它从那个writeHost获取同步数据。
		因此，当它所属的writeHost宕机了，则它也不会再参与到读写分离中来，即“不工作了”。这是因为此时，它的数据已经“不可靠”了。
		基于这个考虑，目前mycat 1.3和1.4版本中，若想支持MySQL一主一从的标准配置，并且在主节点宕机的情况下，从节点还能读取数据。
		则需要在Mycat里配置为两个writeHost并设置banlance=1。”--&gt;</span>
	<span class="token comment">&lt;!--switchType：设置节点切换操作，有三个值可选
		-1：不自动切换
		1：自动切换，默认值
		2：基于mysql主从同步的状态决定是否切换
	--&gt;</span>
	<span class="token comment">&lt;!--slaveThreshold：主从同步状态决定是否切换，延迟超过该值就不切换--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataHost</span> <span class="token attr-name">balance</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">maxCon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">minCon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>localdh<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dbType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mysql<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dbDriver</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jdbc<span class="token punctuation">&quot;</span></span> <span class="token attr-name">writeType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">switchType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">slaveThreshold</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1000<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!--查询心跳--&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>heartbeat</span><span class="token punctuation">&gt;</span></span>select user()<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>heartbeat</span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!--配置写节点实际物理数据库信息--&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>writeHost</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jdbc:mysql://localhost:3306<span class="token punctuation">&quot;</span></span> <span class="token attr-name">host</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>host1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">password</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span> <span class="token attr-name">user</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>writeHost</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dataHost</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">mycat:</span>schema</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><ol start="2"><li><strong>修改rule.xml</strong></li></ol> <p>​	在schema.xml中已经指定规则为mod-long。因此需要到该文件中修改对应信息。</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tableRule</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mod-long<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 当前用于 id 取模的字段 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>columns</span><span class="token punctuation">&gt;</span></span>user_id<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>columns</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>algorithm</span><span class="token punctuation">&gt;</span></span>mod-long<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>algorithm</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rule</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tableRule</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!--修改当前的分片数量--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>function</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mod-long<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>io.mycat.route.function.PartitionByMod<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!-- how many data nodes --&gt;</span>
		<span class="token comment">&lt;!-- 根据datanode数量进行取模分片，也就是要模几。 --&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>count<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>function</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ol start="3"><li><strong>新增数据</strong></li></ol> <ul><li><p>向数据库中插入9条数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_emp<span class="token punctuation">(</span>emp_id<span class="token punctuation">,</span>emp_name<span class="token punctuation">,</span>emp_salary<span class="token punctuation">,</span>dept_id<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">,</span> <span class="token string">'tom11'</span><span class="token punctuation">,</span><span class="token number">1111</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_emp<span class="token punctuation">(</span>emp_id<span class="token punctuation">,</span>emp_name<span class="token punctuation">,</span>emp_salary<span class="token punctuation">,</span>dept_id<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">,</span> <span class="token string">'tom12'</span><span class="token punctuation">,</span><span class="token number">2222</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_emp<span class="token punctuation">(</span>emp_id<span class="token punctuation">,</span>emp_name<span class="token punctuation">,</span>emp_salary<span class="token punctuation">,</span>dept_id<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token string">'tom13'</span><span class="token punctuation">,</span><span class="token number">3333</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_emp<span class="token punctuation">(</span>emp_id<span class="token punctuation">,</span>emp_name<span class="token punctuation">,</span>emp_salary<span class="token punctuation">,</span>dept_id<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token string">'tom14'</span><span class="token punctuation">,</span><span class="token number">4444</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_emp<span class="token punctuation">(</span>emp_id<span class="token punctuation">,</span>emp_name<span class="token punctuation">,</span>emp_salary<span class="token punctuation">,</span>dept_id<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">'tom15'</span><span class="token punctuation">,</span><span class="token number">5555</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_emp<span class="token punctuation">(</span>emp_id<span class="token punctuation">,</span>emp_name<span class="token punctuation">,</span>emp_salary<span class="token punctuation">,</span>dept_id<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">,</span> <span class="token string">'tom16'</span><span class="token punctuation">,</span><span class="token number">6666</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_emp<span class="token punctuation">(</span>emp_id<span class="token punctuation">,</span>emp_name<span class="token punctuation">,</span>emp_salary<span class="token punctuation">,</span>dept_id<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">27</span><span class="token punctuation">,</span> <span class="token string">'tom17'</span><span class="token punctuation">,</span><span class="token number">7777</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_emp<span class="token punctuation">(</span>emp_id<span class="token punctuation">,</span>emp_name<span class="token punctuation">,</span>emp_salary<span class="token punctuation">,</span>dept_id<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">,</span> <span class="token string">'tom18'</span><span class="token punctuation">,</span><span class="token number">8888</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_emp<span class="token punctuation">(</span>emp_id<span class="token punctuation">,</span>emp_name<span class="token punctuation">,</span>emp_salary<span class="token punctuation">,</span>dept_id<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">29</span><span class="token punctuation">,</span> <span class="token string">'tom19'</span><span class="token punctuation">,</span><span class="token number">9999</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p>通过id查询数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> emp_id<span class="token punctuation">,</span>emp_name<span class="token punctuation">,</span>emp_salary<span class="token punctuation">,</span>dept_id <span class="token keyword">FROM</span> t_emp <span class="token keyword">WHERE</span> emp_id<span class="token operator">=</span><span class="token number">18</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> emp_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="data:image/png;base64,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" alt="images"></p></li> <li><p>查询所有数据</p></li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> emp_id<span class="token punctuation">,</span>emp_name<span class="token punctuation">,</span>emp_salary<span class="token punctuation">,</span>dept_id <span class="token keyword">FROM</span> t_emp <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> emp_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/code_heavy_industry/assets/img/img010.69788793.png" alt="images"></p> <ul><li>常见错误：</li></ul> <blockquote><p>bad insert sql (sharding column:ID not provided,INSERT INTO t_emp (emp_id, emp_name, emp_salary, dept_id)
VALUES (21, 'tom11', 1111, 1)</p></blockquote> <p>在分片过程中需要用到的 ID 字段，在 insert 语句中没有找到。</p> <ol start="4"><li><strong>问题分析</strong></li></ol> <ul><li><p>散列不均匀，出现数据倾斜</p> <ul><li>每张表中的数据量差距较大</li></ul></li> <li><p>动态扩容时，存在重新计算，出现数据丢失</p> <ul><li>动态扩容后新增表时，需要对模数修改时有可能就会造成当查询某个分片时，在该分片中找不到对应数据</li></ul></li></ul> <h3 id="_2-全局id分片"><a href="#_2-全局id分片" class="header-anchor">#</a> [2]全局id分片</h3> <p><img src="/code_heavy_industry/assets/img/img012.20462bc1.png" alt="images"></p> <p>当进行数据切分后，数据会存放在多张表中，如果仍然通过数据库自增id的方式，就会出现ID重复的问题，造成数据错乱。所以当拆分完数据后，需要让每一条数据都有自己的ID，并且在多表中不能出现重复。比较常见的会使用雪花算法来生成分布式id。</p> <p>在Mycat中也提供了四种方式来进行分布式id生成：基于文件、基于数据库、基于时间戳和基于ZooKeeper。</p> <h4 id="_1-基于本地文件"><a href="#_1-基于本地文件" class="header-anchor">#</a> (1)基于本地文件</h4> <p><strong>优点：</strong></p> <ul><li>本地加载，读取速度较快</li></ul> <p><strong>缺点：</strong></p> <ul><li><p>MyCAT重新发布后，配置文件中的sequence会初始化，然后重新开始。从而造成 ID 重复。</p></li> <li><p>MyCat如果存在多个，会直接出现id重复冲突</p></li></ul> <p><strong>配置方式：</strong></p> <ol><li>修改<strong>sequence_conf.properties</strong></li></ol> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token comment"># 使用过的历史分段，可不配置</span>
<span class="token attr-name">USER.HISIDS</span><span class="token punctuation">=</span>

<span class="token comment"># ID 每次增加的值</span>
<span class="token attr-name">USER.MINID</span><span class="token punctuation">=</span><span class="token attr-value">1</span>

<span class="token comment"># 最大ID值</span>
<span class="token attr-name">USER.MAXID</span><span class="token punctuation">=</span><span class="token attr-value">200000</span>

<span class="token comment"># 当前ID值</span>
<span class="token attr-name">USER.CURID</span><span class="token punctuation">=</span><span class="token attr-value">1000</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ol start="2"><li>修改<strong>server.xml</strong></li></ol> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!--设置全局序号生成方式
   0：文件
   1：数据库
   2：时间戳
   3：zookeeper
  --&gt;</span>
<span class="token comment">&lt;!--必须带有MYCATSEQ_或者 mycatseq_进入序列匹配流程 注意MYCATSEQ_有空格的情况--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sequenceHandlerType<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sequnceHandlerPattern<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>(?:(\s*next\s+value\s+for\s*MYCATSEQ_(\w+))(,|\)|\s)*)+<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>subqueryRelationshipCheck<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- 子查询中存在关联查询的情况下,检查关联字段中是否有分片字段 .默认 false --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sequenceHanlderClass<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>io.mycat.route.sequence.handler.HttpIncrSequenceHandler<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>测试:</strong></p> <p>插入数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">insert</span> <span class="token keyword">into</span> t_user<span class="token punctuation">(</span>user_id<span class="token punctuation">,</span>user_name<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'next value for MYCATSEQ_USER'</span><span class="token punctuation">,</span><span class="token string">'wangwu'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/code_heavy_industry/assets/img/img013.123714b5.png" alt="images"></p> <h4 id="_2-数据库"><a href="#_2-数据库" class="header-anchor">#</a> (2)数据库</h4> <ul><li>在<span style="color:blue;font-weight:bold;">物理库</span>执行dbseq.sql中的sql语句，执行完毕后，会创建一张表</li></ul> <p><img src="data:image/png;base64,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iIgUDE6IiIiIiMgSdKN13blzp6ydH3vssYpfEBEREdFq4mhdRKtHF5zwYSQiIiIiotXCZl1ERERERGQJDE6IiIiIiMgSGJwQEREREZElMDghIiIiIiJLYHBCRERERESWwOCEiIiIiIgsgcEJERERERFZAoMTIiIiIiKyBAYnRERERERkCQxOiIiIiIjIEhicEBERERGRJTA4ISIiIiIiS2BwQkRERERElsDghIiIiIiILIHBCRERERERWQKDEyIiIiIisgQGJ0REREREZAkMToiIiIiIyBIYnBARERERkSUwOCEiIiIiIktgcEJERERERJbA4ISIiIiIiCyBwQkREREREVkCgxMiIiIiIrIEBidERERERGQJDE6IiIiIiMgSGJwQEREREZElMDghIiIiIiJLYHBCRERERESWwOCEiIiIiIgsgcEJERERERFZAoMTIiIiIiKyBAYnRERERERkCQxOiIiIiIjIEhicEBERERGRJTA4ISIiIiIiS2BwQkRERERElsDghIiIiIiILIHBCRERERERWQKDEyIiIiIisgQGJ0REREREZAkMToiIiIiIyBIYnBARERERkSUwOCEiIiIiIktgcEJERERERJbA4ISIiIiIiCyBwQkREREREVkCgxMiIiIiIrIEBidERERERGQJDE6IiIiIiMgSGJwQEREREZElMDghIiIiIiJLYHBCRERERESWwOCEiIiIiIgsgcEJERERERFZAoMTIiIiIiKyBAYnRERERERkCQxOiIiIiIjIEhicEBERERGRJfx/AvZ3hwgPXmUAAAAASUVORK5CYII=" alt=""></p> <ul><li>修改sequence_db_conf.properties</li></ul> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">TB_USER</span><span class="token punctuation">=</span><span class="token attr-value">localdn</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>修改server.xml文件</strong>，修改全局序列号生成方式为数据库方式</li></ul> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sequenceHandlerType<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>修改schema.xml, 在table中添加自增属性</li></ul> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tb_user<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dataNode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>localdn<span class="token punctuation">&quot;</span></span> <span class="token attr-name">primaryKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">subTables</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tb_user$1-3<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rule</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mod-long<span class="token punctuation">&quot;</span></span> <span class="token attr-name">autoIncrement</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>执行语句</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">insert</span> <span class="token keyword">into</span> tb_user<span class="token punctuation">(</span>user_id<span class="token punctuation">,</span>user_name<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'next value for MYCATSEQ_TB_USER'</span><span class="token punctuation">,</span><span class="token string">'wangwu'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>对应关系</li></ul> <p><img src="/code_heavy_industry/assets/img/img014.c2032a86.png" alt="images"></p> <h4 id="_3-zookeeper"><a href="#_3-zookeeper" class="header-anchor">#</a> (3)zookeeper</h4> <ul><li>修改<strong>server.xml</strong>，更改生成模式</li></ul> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sequenceHandlerType<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>修改<strong>myid.properties</strong>，配置zk连接信息</li></ul> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">loadZk</span><span class="token punctuation">=</span><span class="token attr-value">true</span>
<span class="token attr-name">zkURL</span><span class="token punctuation">=</span><span class="token attr-value">192.168.200.131:2181</span>
<span class="token attr-name">clusterId</span><span class="token punctuation">=</span><span class="token attr-value">01</span>
<span class="token attr-name">myid</span><span class="token punctuation">=</span><span class="token attr-value">mycat_fz_01</span>
<span class="token attr-name">clusterNodes</span><span class="token punctuation">=</span><span class="token attr-value">mycat_fz_01</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>修改<strong>sequence_distributed_conf.properties</strong></li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>INSTANCEID=ZK #声明使用zk生成
CLUSTERID=01
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>新增数据</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#MYCATSEQ_这个后缀可以随便写即可</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> tb_user<span class="token punctuation">(</span>user_id<span class="token punctuation">,</span>user_name<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'next value for MYCATSEQ_TB_AAAA'</span><span class="token punctuation">,</span><span class="token string">'atguigu'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>特点
<ul><li>ID 结构：<strong>long 64 位</strong>，ID 最大可占 63 位</li> <li>可以承受单机房单机器单线程 1000*(2^6)=640000 的并发。</li> <li>无悲观锁，无强竞争，吞吐量更高</li></ul></li></ul> <h4 id="_4-时间戳"><a href="#_4-时间戳" class="header-anchor">#</a> (4)时间戳</h4> <ul><li><p>修改<strong>server.xml</strong>。更改生成方式</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sequenceHandlerType<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>修改<strong>sequence_time_conf.properties</strong></p></li></ul> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token comment">#sequence depend on TIME</span>
<span class="token comment"># WORKID 与 DATAACENTERID: 0-31 任意整数。多 mycat 节点下，每个节点的 WORKID、DATAACENTERID 不能重复，组成唯一标识，总共支持32*32=1024 种组合</span>
<span class="token attr-name">WORKID</span><span class="token punctuation">=</span><span class="token attr-value">01</span>
<span class="token attr-name">DATAACENTERID</span><span class="token punctuation">=</span><span class="token attr-value">01</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><p>新增数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#MYCATSEQ_这个后缀可以随便写即可</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> tb_user<span class="token punctuation">(</span>user_id<span class="token punctuation">,</span>user_name<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'next value for MYCATSEQ_TB_BBBB'</span><span class="token punctuation">,</span><span class="token string">'atguigu'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>特点</p> <ul><li>不存在id重复的现象</li> <li>数据类型太长，建议字段类型采用bigint(最大取值18446744073709551615)</li></ul></li></ul> <h3 id="_3-枚举分片"><a href="#_3-枚举分片" class="header-anchor">#</a> [3]枚举分片</h3> <p><img src="/code_heavy_industry/assets/img/img017.9235a141.png" alt="images"></p> <p>适用于在特定业务场景下，将不同的数据存放于不同的数据库中，如按省份存放订单、按存放人员信息等。</p> <ol><li>修改<strong>schema.xml</strong>，修改<strong>table</strong>标签中<strong>name</strong>属性为当前操作的表名，<strong>rule</strong>属性为<strong>sharding-by-intfile</strong></li></ol> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tb_user_sharding_by_intfile<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dataNode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dn129,dn130<span class="token punctuation">&quot;</span></span> <span class="token attr-name">primaryKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user_id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rule</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sharding-by-intfile<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="2"><li>修改<strong>rule.xml</strong>，配置<strong>tableRule</strong>为<strong>sharding-by-intfile</strong>中<strong>columns</strong>属性为当前指定分片字段</li></ol> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tableRule</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sharding-by-intfile<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>columns</span><span class="token punctuation">&gt;</span></span>sex<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>columns</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>algorithm</span><span class="token punctuation">&gt;</span></span>hash-int<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>algorithm</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rule</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tableRule</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ol start="3"><li>修改<strong>rule.xml</strong>中<strong>hash-int</strong></li></ol> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>function</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hash-int<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>io.mycat.route.function.PartitionByFileMap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mapFile<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>partition-hash-int.txt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--type 属性：指定枚举值类型。默认值为0，0表示Integer，非零表示String--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>type<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--defaultNode 当有一些特殊数据信息可以存放于默认节点中，如即不是male也不是female。默认节点：小于0表示不设置默认节点，大于等于0表示设置默认节点,不能解析的枚举就存到默认节点--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>defaultNode<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>function</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ol start="4"><li>修改<strong>partition-hash-int.txt</strong>。指定分片字段不同值存在于不同的数据库节点</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>male=0 #代表第一个datanode
female=1 #代表第二个datanode
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="5"><li><p>配置中的注意点</p> <p>table 标签中不写 subTables 属性，原因是对照枚举规则之后，不同的数据进入了不同数据库中。在各自数据库中的表名是相同的。</p> <p>在 partition-hash-int.txt 文件中，0 和 1 这些值表示序号，这个序号对应 table 标签中 dataNode 属性值中 dataNode 名称的顺序。比如：dataNode=&quot;dn-docker-female,dn-docker-male&quot; 这个例子中，dn-docker-female 的序号是 0，dn-docker-male 的序号是 1。</p></li> <li><p>注意事项</p> <p>==<strong>该方案适用于特定业务场景进行数据分片，但该方式容易出现数据倾斜，如不同省份的订单量一定会不同。订单量大的省份还会进行数据分库，数据库架构就会继续发生对应改变。</strong>==</p></li></ol> <h3 id="_4-固定hash分片"><a href="#_4-固定hash分片" class="header-anchor">#</a> [4]固定hash分片</h3> <p>固定hash分片的工作原理类似与redis cluster槽的概念，在固定hash中会有一个范围是0-1024，内部会进行二进制运算操作，如取 id 的二进制低10 位 与 1111111111 进行&amp;运算。从而当出现连接数据插入，其有可能会进入到同一个分片中，减少了分布式事务操作，提升插入效率同时尽量减少了数据倾斜问题，但不能避免数据倾斜。</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA4wAAACmCAYAAACRFQFvAAAgAElEQVR4nO3df0xV9/3H8ReVfb1aiRdpU65hWGZrY6Gy7Dqz4ZwrmEEbGzJi1mbTljZC27TUdcn+mZMqhmWbaTa92bKCWWjWP7rG0JCaDrqCsatkMdylWqhJ1aHsIrSWHw6V21bl+4c5t/fH58KFc+Hei89H0tR77jnv8zlv7r3nvM85n89J6+/vn1i+fLniZWxsTBkZGbdMvAsXLoj8zRz5s4f82UP+7CF/9pA/e8ifPeTPHvJnD/mzZ67zd1vc1gQAAAAAmFcoGAEAAAAARhSMAAAAAAAjCkYAAAAAgBEFIwAAAADAiIIRAAAAAGBEwQgAAAAAMKJgBAAAAAAYUTACAAAAAIwoGAEAAAAARhSMAAAAAAAjCkYAAAAAgBEFIwAAAADAiIIRAAAAAGBEwQgAAAAAMKJgBAAAAAAYUTACAAAAAIzS+vv7JzIyMhLdjpQ1NjYm8jdz5M8e8mcP+bOH/NlD/uwhf/aQP3vInz3kz565zl+6pLiuMN4bQDziEY94xCMe8YhHPOIRj3jES0w8bkkFAAAAABhRMAIAAAAAjCgYAQAAAABGFIwAAAAAACMKRgAAAACAEQUjAAAAAMCIghEAAAAAYETBCAAAAAAwomAEAMxLixYtSup4AACkAgpGAMC8lJ6entTxAABIBRSMAAAAAAAjCkYAAAAAgNG8LxgnJiYS3QQAAAAASYp6YXLzsmD85JNP9Prrr6u6ulrvv/9+opsDAJgFLS0t2rlzp/x+f9T33W534L+WlpaIebxeb8g8brdbXq930vX6/X7t3LlTmzdvVm9vb1y2BQCQOO+//76qq6v1+uuv65NPPkl0c5LOvOnB7/P51NHRoSNHjujkyZOB6du2bUtgqwAA8eb1elVdXS1JKisrM87j8XjU1dWl9vZ2OZ3OkGXKy8slSb29vdq/f78OHTqkvLy8kNi1tbWB+cL19PSotbVVLpcr3psGAEgQr9crr9erffv2KT8/X5s2bVJxcbFycnIS3bSES+mC8dy5c+ro6FBHR4dOnTqV6OYAAGaR3+/X3r17lZ2drWPHjmnv3r3G+Xp7e9XW1qY9e/bI6XRKktxutyorK9Xc3KyNGzfK6XQqMzNTDQ0NcjgcgWVN8wUbHR3VgQMHZm8jAQAJ19PTo56eHu3fv1+rV69WcXGxiouLdffddye6aQmRcgXj6dOn1d7eriNHjujMmTOJbg4AYI44HA7V19dLUtTbUCXp5MmTysrK0sqVK0OmFxUVqampSWfPnpXb7Y4oBi25ubnq6uoyvnf06FFJ0nPPPafm5uaZbAYAIIWcOnVKp06d0h//+Efdc889evDBB1VcXKxVq1YlumlzJiUKxp6eHv3jH//Qe++9p/Pnz09r2e7u7pCOrFevXrX98OW0tLTAv4eGhpSVlRXTcrF0qB0fH5+0fdPtlOv3+0POnts1VfsmE9x2K4fDw8NatmzZtJefSftm0qE5WfNnGRkZUWZmpt1mBSRz/iYmJuL+9xgZGYnp8xfrttv5+04WLx6d8Wcrf5mZmSG/idHWHYto7fv+978fc179fr+OHz+unJyciFjLli2Ty+WSz+eT2+2OGqOvr884vbe3V42NjdqzZ498Pp9xnnfeeUc3btwImRZt+4O/v9FyOJ2/fbT8zfTzkwy/f5O1Pd6/f6bttfPdi0f+gtcf77/H6OhoxEmT8M9hPD5/MzU+Pp5y+ZO+ymE8jtcS/fmzE2+qtkfLn3Qzh3bzN93lT58+HdN8Z86c0ZkzZ9TY2KgVK1Zow4YN+uEPf6j8/PxprS/VpEvShQsX4hYwIyMjLvFOnTqlzs5O/etf/9Lg4OCM4xw8eNB2WwAAifPWW29Nu9DIzs6OOLjJzMyc8gSfdTtraWlpyMGM3+/XwYMHVVhYqPz8/KgFY21trb788stptRUAkHrOnz+v8+fP67XXXtNdd92l7373uyoqKtLq1asj5o1XfRRsLuu3dElavnx53FY4NjYWl3gXL17UkiVLpjxzDQBAPPT29qqmpkZZWVkRA6a1tbXpxIkT8ng8cT1rDwBIfQsWLNCSJUt0xx13GOugeNVHlgsXLsxp/Za0t6QWFhaqsLBQ27dvV19f34xvSa2qqgq5TDzdW2KmKlinuiV1upfEg9sXj2J5prfIRVt3vG+5M92Same7r169qsWLF9ttVkC8Py9TxZvutk/nluhYzNYtlVOJdbuj/X1n+pn57LPPdMcddxjfi/W7G7zumXz+Jmt7vD/P4fHs/sZM9vmbKn+mdUfb3nh+xqNpaWlRXV2dXC6Xdu/eHXJ10ev1qq6uTg0NDYHRVKP505/+FPO2z+TzN5efF9P3N5G/z+Hrnix/MzGb+bP7XUtLS9OVK1d0++23x6NpkqLnz9R9JBaz8Xtld3uD2z+X+ZvJ3zue+UtLS5v1/cdk647FxYsXdeedd4ZMm2nuptO+aD744AO9/PLL01pmxYoV2rhxozZt2nRr3JKa7PLz85Wfn6+f/exn+vjjjwOPz4hl0Jv8/Hxt2LAh8HpsbEwZGRlxa9tsVPjxbF+yxyN/9pA/e8ifPcmcv8HBwYg+LSMjIxoaGgqZzxp5tbW1VWVlZdq1a1fIMtaoqJWVlZP2e7R861vfirmNyZy/VIhH/uwhf/aQP3uSLX/h+4ZorEFvSkpKdO+99854fakmJQrGYKtWrdKqVav0zDPP8FgNAEAIh8Oh7OxsdXV1RRSMw8PDkqQ1a9ZICi0Woz138ejRo+ru7lZ3d7eampoi3t+yZYtcLpcOHjyo7OzsWdoqAECi8FiNFCwYg91999166qmn9NRTT8nn8wWuPJ48eTLRTQMAJEj44zMsnZ2dKiwslMvlknRzBO7JikVJKi8vN77X0tKixsZGeTyeKW9TBQCklvz8fG3atEnFxcXKyclJdHMSLqULxmA5OTl6/PHH9fjjj+uTTz7RkSNH1NHRkehmAQDmWH5+vsrKynTgwAHt379fTqdTXq9XTU1NamhoCFx17OzsVEFBgTZu3JjgFgMAEs3tdqu4uFgPPvigFi9eHNdbcFPdvCkYg91111167LHH9Nhjj8Xl+WUAgNThcDhUX18vj8ejkpISSZLL5dKhQ4cirgZ2d3cH5gk32ZVHAMD88b3vfS9izBN8ZV4WjMF4LAcAzD9WUTiZmpoa1dTUzPj9yUS7VRUAkHqoFyZ3W6IbAAAAAABIThSMAAAAAAAjCkYAAAAAgBEFIwAAAADAiIIRADAvXbt2LanjAQCQCigYAQDz0vj4eFLHAwAgFVAwAgAAAACMKBgBAAAAAEYUjAAAAAAAIwpGAAAAAIARBSMAAAAAwCitv79/IiMjI9HtSFljY2MifzNH/uwhf/aQP3vInz3kzx7yZw/5s4f82UP+7Jnr/KVLiusK470BxCMe8YhHPOIRj3jEIx7xiEe8xMTjllQAAAAAgBEFIwAAAADAiIIRAAAAAGBEwQgAAAAAMKJgBAAAAAAYUTACAAAAAIwoGAEAAAAARhSMAAAAAAAjCkYAAAAAgBEFIwAAAADAiIIRAAAAAGBEwQgAAAAAMKJgBAAAAAAYUTACAAAAAIwoGAEAAAAARhSMAAAAAAAjCkYAAAAAgBEFIwAAAADAKK2/v38iIyMj0e1IWWNjY0ql/C1atCjRTQhx7do1paenT3u58fHxWWhN6km1z1+yIX/2kD97kil/t912mxYuXJjoZkzLTPcfs+Hzzz/XjRs3Et2MaUmmz18qIn/2kD975jp/6ZLiusJ4bwDxkitevM10Zx9tm5I9f8QjHvGIlyrxkl2yFIuSuS3J/vclHvGIR7xY43FLKgAAAADAiIIRAAAAAGBEwQgAAAAAMJqXBePFixf1xhtv6JlnnlFnZ2eimwPMimPHjulXv/qV3njjDV28eHHW18f3CgAAzGfHjh3Ts88+qzfffHNOjq1SRfL0GLfpwoUL6ujoUEdHh06ePKmJiQlJ0k9/+tMEtyy5eb1eVVdXB15XVlaqpqYm5uX9fr/27t2r1tbWwLSysjLt2rVLDocjMK23t1c1NTUaGBgIWb6goED79++X0+mUJLW0tKiuri5iPdNt163g+vXrOnHihE6cOKHf/e53KiwsVElJiYqLi5WdnR2XdfC9Am5N4fsGSWpoaJDb7Q68Hh0d1Y4dO9Td3R0yn8vlksfjUV5eXsj08P2FaV8RK4/HI0nG/UL4eqK1x+PxqKmpKfA6fH9kYu3LCgsLZ9x2AMnr+vXrOn78uI4fP64DBw7MyrFVKkrpgvHcuXNqb2/XkSNHdOrUqUQ3J+W0tLSosbFRhw4dUl5eXmBHKJl3wiaNjY3Kzs6W1+uV9NWO+umnnzbueMMPOExi2Wkj1MTEhD744AN98MEHevnll3X//ferpKREJSUl+vrXvz6tWHyvgFtbb2+v9u/fH9g3SF8VkLW1tSovLw+Z3zTNFLOmpkZVVVWqr68PxGxra5ty2WDBJxUrKysj3reK2LVr1wb2Sx6PRzU1NSFFY0tLiwYHB3Xs2LFA0efxeLR161ZjcWk5fPiwBgYGVFhYGHObAaSmeB5bpbqUKxg//vhjvfvuuzpy5Ij+85//RLw/MTGhtLS0BLQstYyOjqq5uVlVVVWBHWNeXp6qqqrU2NiozZs3R91hBtuyZYtcLlfgtcPh0Pbt21VTU6OjR48GDgSGh4cjri6a9PX1zXCLEPzZ/+ijj/TRRx/J4/Ho3nvvVXFxsUpKSrRy5Urjstb3qr29XefOnZs0NoD5LTMzUw0NDSFXz9xutyorK9Xc3KyNGzfK6XRqZGREQ0NDU8bz+/06ePCgqqqqQopDt9s95QlEi1UIVlRUqL29XTt27DDOd/ToUUnStm3bAtO2bdumrq4uHT58OHAydN26dRGFqmm+YF6vN+SKJID5z86x1XyS9AXjxMSEPvzwQ73zzjs6evSo+vv7jfNYwg9qz507J6fTqbS0NKWlpenq1au6/fbbI+a1/m3NF+v7n376qb744osp57M+cOGxrWnW+5cvX9bVq1eN882krZcvXw6ZtmjRIi1YsEBnz57V0NCQ1qxZE5Iv6/XJkydjKhiDi0VLZmamsrKyjPMuW7Zsypg5OTnc5jND1uco+Afu9OnTOn36tF555RWtWLFCGzZsUGlpqa5fvz7j79XZs2e1ZMkSYxuC57169aoWL15sLDbDp8VSkAZ/f6cbyzTt4sWLunTp0rSXizbtypUrxvbNNL4Vb6rlrL/VVPNduXLF+HebbLnJPgeffvppyPuxtCFafOv36sqVKzOOFf768uXL8vv9014u2rTLly/r2rVrMX1WY1nf5cuXNTY2FtOyscwzPj6uBQsWTDpftNhpaWlauHChJEW9uyM3N1ddXV0R03NyciZta09Pj3w+n37xi19MOt9knE6nXn31VUk3i0cTv9+v48ePa+3atSHb4HQ6tXbtWnV1dWl0dFROp9O473I4HFG3xe/3q7m5WVu2bAnsVwHcGmI9tiorK9Pq1asT3NrZkZQF48TEhE6cOKH29na9++67+vTTTyedd7Kd6x/+8IfZaGLK8ng8KioqUmdnp7KyspSZmRnyvlXs2bnSZzrr7PP5plzO7/drcHBwyvnee+897dq1S5K58L7ttq/GcopWoFv/nqqQv379euAALJYCfap13LhxwxgvOFasJwvCDzTDY5l+4M6dO6fz58/rtddei5rf4GWjsfoPAZgfcnNz9eabb046T/h+IdY7Rzo7OyOKuNkwMDCgEydOaN26dRHv5ebmqq2tTSMjI1Hb4ff75fP5jP2U2tra5PP59Nvf/tb4+/foo4+qr68v5pMcscxj+k0P3r/FGjvafNH2lzONH7zfsHvyTZJu3Lhh3E/GGiv8dfD+V4r9RFu0ea5fv6709HTjfJOdaIu2vhs3bsT894il7cHx4nHS1ooXj5NvkvTll1/qa1/7WlxiWe0LP2EWy3Lh0/73v/9N+r7p2Or8+fOBY6vly5cHrjw+8MADMX+Hkl1SFozSVwfO8yXRych0JW+yM6yxOnz4sCRFXL0cGBjQli1bAq+jDWTT2toaMohOeL/Ha9eucYZ3hqwfOevfABCL3t5etbW1qbS0NKLgCh4cJ3wgG+tE4Lp16yIGNYul7+NMmPZhsezXjh49qu7ubr3wwgsh03t7e9XY2KiqqqqoxeYXX3wRcrcRgFvT9evXdePGDd24cSPRTYmrpCwY09LSVFhYqMLCQlVVVcnn8+nvf/+7/vnPf0ac4Qw+ALZeB6uqqtL9998fmO/q1auBHdnExETIstZra5rp/+HLDA8PB3Yg8Yjn9/v1f//3fxHzRIsZPk/w+2lpafL7/SFnwGa7k6416lxtbW3ILa3l5eUhBwbWAAqDg4OBgwuHw6H6+vrAgAhWvPCBFrKzs/Xwww8bt/natWtKT0+fNCemv0u0HE8Vz7SM9Tr8/1Y86wxYrG2IFu/KlSshV2TDC0HTmd6FCxdq6dKl2rdvnxYsWDDj79Wzzz6rgoKCkGnhtyZOTEzI7/dr0aJFxvdifR28XePj4xEnOWJZ1hRLkoaGhkJuk55JrGDj4+NatGjRtJc1xZJu/h5YtwnajWW1Lzh/dmJNTEzo0qVLWrp06ZTLTvV3sF5//vnnWrhw4YxyZzqzH54/O7EmJiYC7Ys1limOdPOAQpLGxsaUkZGheAluX7Dgg5do2xjLyKBZWVkhfQPdbndgYJng+YIHPbOu2rW2tqqysjIwv7UP6OvrS4oRsK1itrKyMuQEpdX/srCwUKWlpVGX37Rpk4aHhwOvJyYmQq6gTPVdiuW1FS8esaTI3wM7sYL3l8HvRfsOxPIdD97/Ros1nTYG73/txpJufjaCjyens6xpvcF3NE13WdNrUzw7+7jweHb3cdE+zzM9PrCuSNuN5ff79dlnnxnXYfq/FHpsFX5sNF8kZcEYbvXq1Vq9erV+/vOf68yZM2pvb1dHR4fOnDkjKbIvT/Dr/Px8bdiwIfA63jvoCxcuaPny5XGLF+/22Y1nehyG6cpg8PDqlZWVU541drvdamhoUHV1tSoqKqIOfGCtJ3ighfvvv1979+41zp9s+ZvNeO+9955efPHFkGmmH7JvfOMbKi4uVnFxse67776Q+cO/V++++25gMKnJvlf33XefvvOd70zZxmTOnzT/v7+zHY/82ZPs+ZO+KqRcLpd27949aWGZl5cXGJE0eNAz6eaVx6qqqsBraxCd4H6F4Y+5iPY4jHgKfgRHeBulmyOB+3w+7d+/Xw6HI9AnNtxzzz0XMY3P3/yOR/7sSdb8xePYaj5KiYIx2D333KN77rlHTz/9tPr6+tTe3q729vbA8P/cZhc7n88XcoZMiuzDkZeXF7jFNJrg53XF8tgMy8qVK1VQUCCfzzfpMkVFRVP2PUHoZ3/16tWBH7K77757ymWt79VPfvITjYyM8L0CbnHhhVSszxx0uVwqLCyMuGshOzs7Yvnw3/aampq4XG007VNM/eiDT4iabo+1RkVtaGhg3wPcouwcW80nKVcwBsvNzdWTTz6pJ598UgMDA4Erj8EPGIdZtAEArAFrioqKYopjFYs8OzGx0tLS9MADDwQeLmvnrB3fK+DWFlws2u1nGI9+8bGabNC2vr4+FRYWBkZHDX7ucPDzJi3WqKhSaB/NYK2trdq6dWvE1QgA80M8j61SXUoXjMFcLpe2bt2qrVu36uLFi+ro6NCRI0ciRhTDTdEen3Hy5EllZWXF9EwZa4c602Lx7NmzxgEGwkUb0fVWt2DBAq1Zs0YPPfSQHnzwQd15551xXwffK+DW09PTM+NiMXykUofDoXXr1qm5uTlw66kl3r/tpsdnSDe7THR1damioiJwldO6cybaLa+mPvXSV8W0pJivugJIHQsWLNC3v/1tFRUV6aGHHpqVY6tUNC+P+u688049+uij+vOf/6z169cnujlJKS8vT6WlpWpsbFRvb6+kr0aCq6ioiKn4sw4MYpn/L3/5S2A90ldXJoMHGBgdHZXH4wnpI2L1aXnhhRe4ehlm/fr1qq+v149//OM5+UHjewXcGjo7O1VQUKCNGzdOOl9LS4tx0JvwAWJKS0uVk5Ojv/71r4Fp1u2e8f5t37x5s4aGhkLWZf3b2h6rgCwtLZ3V/pEAUs/69ev15z//WT/60Y8oFoPMmyuMmL6amhrl5uaGPOpiOn0QLXV1dSFDpVuCrzxeuXIlZD3R1tXV1RUy6EFBQYHa29spFgFgDnV3d6ukpMT4XvCVx/DbNU1XJR0Oh3bt2qW9e/cGfvNdLpfxVlC78vLy9Nprr2nHjh2BdZWVlemVV16JuBrY1NQUsr+xzMVgOwCQStL6+/snknGUolSJl6yjPM1WvGSX7Pnj85dc8cifPeTPnmTPH+zh8ze/45E/e8ifPXOdv7T+/v4JdjAzl2o76EWLFoU8lzEVXbt2TePj44luRlJItc9fsiF/9pA/e5Ipf7fddptuv/32RDcjZV25ciXlHtSdTJ+/VET+7CF/9sx1/tIlJXUFTbzkipcM0tPTo25TsuePeMQjHvFSJR5iZyq2k/3vSzziEY94scabl4PeAAAAAADso2DEtFy7di2u8YJHRAUAJI94/94n+/4j3u0DgPmCghHTEu++g8PDw3GNBwCIj3j/3if7/oO+8QBgRsEIAAAAADCiYAQAAAAAGFEwAgAAAACMKBgBAAAAAEYUjAAAAAAAIwpGAAAAAIARBSMAAAAAwIiCEQAAAABgRMEIAAAAADCiYAQAAAAAGFEwAgAAAACMKBgBAAAAAEYUjAAAAAAAIwpGAAAAAIARBSMAAAAAwCitv79/Ip4BMzIyNDY2dsvEi7dk317yl1zx4i3Zt5f8JVe8eEv27SV/yRUv3pJ9e8lfcsWLt2TfXvKXXPHibar2pfX3908sX748biscGxtTRkbGLRPvwoULIn8zR/7sIX/2kD97yJ895M8e8mcP+bOH/NlD/uyZ6/xxSyoAAAAAwIiCEdPm8Xi0efNm9fb2xnXeeGlpadHOnTvl9/vnbJ0AAADAfETBiKhGR0f1xBNPyOv1Tjmv1+vVE088odHR0TloWfQ2/OAHP1BdXV3C2gAAAADMJxSMiGpkZERDQ0MR02tqanT48GHl5eUFpvl8PmMM07zx5vf7tXPnTnV2dqqtrU1lZWWzti4AAADgVpKe6AYAdjkcDtXX10uSPvvsswS3BgAAAJg/uMKYYnp7e7V582Z5vV61tLTI7XYH/mtpaYmY/+233w6ZJ7xvnxXv2LFj2rlzp9xut37/+99r586d2rJliwYGBlRdXS232y2PxyPpZh9B6/ZTa/m6ujp1d3erpKREbrc7cBtr8LzBvF6v3G63HnnkkUDbwm99nWxbY7lNFgBw64i1z7x1V8pcdKOw9mNT7asBIJlRMKao6upqSTcLL6/Xq4aGBtXV1QWKOuu94Hna29vl8/m0d+/eiAFhXn/9dVVUVMjr9erFF19UfX29Dh06JJfLpYaGBnm9XtXU1ES0Iy8vT4cPH1Ztba0KCgrU3t4eKAaj8Xg8qq6uVkNDg956661A+6urq4070vBtrays1EsvvTSnA+kAAJKD1b/+ww8/nHLeRPavv3Tpknbv3q09e/YE9l+HDh1SY2NjyL4aAJIdBWOKqqysVHl5eeC12+1WZWWlurq6AjtGt9uthx9+ODCP0+lURUWFfD5fRMG4atWqSYu8eOnt7VVbW5tqa2tD1ud2u1VbW6vGxsaIQjB8Wzdv3ixJOnny5Ky3FwCQXOz2r7e6Mbz66qtyOp2z1k6Hw6H9+/eH7Ovy8vJUVVWltrY2TnoCSBn0YUxRubm5EdOKiorU1NSks2fPBnZQly5d0vPPP6/u7u7AfC6XSyMjIyE7SlO82WAVeWvWrIl4LycnRwMDAxoeHg7Z4RcVFYXMl5mZqaysrNltKAAANixcuND4IOycnJwEtAYAZo4rjCkqlh2Ox+NReXl5SLFoJ1489PX1KSsrS5mZmRHvLVu2TC6XK+qIq6ZYAIDEs/qrDw4OBvrDu93uqH0KPR5PSL++8Fs0Y+lf/8tf/nLG/es9Ho/xeb3h/eVN7Y+2rbHe+hrrPg4AkgUF4zzjcrm0bNmywK2fJSUlOnbsWKD/RG1tbULbN9mVzOHhYQ0MDHD2FQBSUHd3t7Zv367t27cH9jmlpaXasmVLyEBlLS0tKioqCunX19bWZuzXN1n/+l//+tdx61/v9/u1d+9eNTY26tChQ4G2VVVVRbTftK3t7e2SpH379kUUocFGR0fV3NyswsJCuVyumPIKAIlGwZiiOjs7jdPCr9498sgjcjgcgdeJviqXk5Oj7u5unT17NuI9n8+ngoICrVy5MgEtAwDYtWfPnpAuBdu2bVNBQUHIPqu8vDyiX19paakGBwcT1r++p6dH7e3tEe0vLy9XZWWlDhw4EHH1MHhea4yAEydOaGBgwLiO0dFR7dixQ0NDQ9q+fXvIvhkAkhkFY4pqamoKGVG0paVFTU1NeuGFF+R0OgP9/I4fPx4xT6ysGKbiNNxkhWAwa3Ce6urqkDO2Xq9XdXV1qqiomNVBCAAAs8O6wyWY0+nU2rVr1dXVpUuXLgWmhz9uoqmpyTgg21z1r+/s7NTq1auNJyxzc3M1NDSkkZGRwDTTyc3J7o7xer0qKSlRd3d3RFEKAMmOgjFFHThwQMePHw/sbK3baKwzsU6nU7t371Z7e3tgnr6+vmndkmqdMW1qajL2MQmWn5+vsrKywDMbJ3tOYk1NjWpra1VdXR14DuNLL72kQ4cOhYyGCgBIHdH6pweznoFo9UOcylx0UfD7/RocHNTy5cuNV/2CB2Sbimk+61FS1q2xc3HFFADiiVFSU5Q1LHh9fX3UefLy8vS3v/0tYpS24KLM6ucRTXl5ecj8Y2NjEdMma49p3uDpFy5c0PLly6O239Q2p9OpV1991bjMwoULJ80JAJkkXTYAAALYSURBVGDu5eTkyOFwqKenR62traqsrAzpe+jxeNTV1ZWQtjkcDmVnZ+u///2v8X2fz2e8ehoLj8ejpqamiO0FgFTCFUYAAGCbqVvC6Oiourq6lJ2drYULF0q6eeuq9Txd6asrfImUm5ur7u5u41XPvr6+GQ1Sc/78ebW1tVEsAkh5FIwAACAuXnrppcBjKPx+v/bt2yfp5uA3kgJX6axn8kpSY2OjWltbY16H1b/+3//+95Tzxtq/vrS0VAUFBaqpqQl5jIbV97+iomLag9T09PRIUkhxDACpiIIxxdxxxx16/vnntWLFikQ3BQCAgIKCAu3Zs0c1NTVyu91av369JOmVV14JDGaWl5enPXv2qK6uLtC/Pjc3V5WVlTGvx+pfb/Xbj0f/eofDoV27dgUeA2K1rbm52Va/w4GBgZB4kz17EgCSVVp/f/9EeB83xG5sbCyijyBiR/7sIX/2kD97yJ898yl/b7/9tt566y395je/0dKlS+dknfMpf4lA/uwhf/aQP3vmOn/pkuK6wnhvAPGIRzziEY94xEvueA6HQwsWLNCSJUuiLjOftpd4xCMe8W6leNySCgAAAAAw4rEaAADAlm9+85taunSpFi9enOimAADijIIRAADYsmLFCgZjA4B5iltSAQAAAABGFIwAAAAAACMKRgAAAACAEQUjAAAAAMCIghEAAAAAYETBCAAAAAAwomAEAAAAABhRMAIAAAAAjCgYAQAAAABGFIwAAAAAACMKRgAAAACAEQUjAAAAAMCIghEAAAAAYETBCAAAAAAwomAEAAAAABil9ff3T2RkZCS6HSlrbGxM5G/myJ895M8e8mcP+bOH/NlD/uwhf/aQP3vInz1znb90SXFdYbw3gHjEIx7xiEc84hGPeMQjHvGIl5h43JIKAAAAADCiYAQAAAAAGFEwAgAAAACMKBgBAAAAAEYUjAAAAAAAIwpGAAAAAIDR/wOrlnvxzbKxrAAAAABJRU5ErkJggg==" alt=""></p> <p>按照上面这张图就存在两个分区，partition1和partition2。partition1的范围是0-255，partition2的范围是256-1024。</p> <p>当向分区中存数据时，先将id值转换为二进制，接着&amp;1111111111，再对结果值转换为十进制，从而确定当前数据应该存入哪个分区中。</p> <ul><li><p>1023的二进制&amp;1111111111运算后为1023，故落入第二个分区</p></li> <li><p>1024的二进制&amp;1111111111运算后为0，故落入第一个分区</p></li> <li><p>266 的二进制&amp;1111111111运算后为266，故落入第二个分区内</p></li></ul> <ol><li>修改<strong>schema.xml</strong>，配置自定义固定hash分配规则</li></ol> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tb_user_fixed_hash<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dataNode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dn129,dn130<span class="token punctuation">&quot;</span></span> <span class="token attr-name">primaryKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user_id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rule</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>partition-by-fixed-hash<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="2"><li>修改<strong>rule.xml</strong>，配置自定义固定hash分片规则</li></ol> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tableRule</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>partition-by-fixed-hash<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>columns</span><span class="token punctuation">&gt;</span></span>user_id<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>columns</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>algorithm</span><span class="token punctuation">&gt;</span></span>partition-by-fixed-hash<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>algorithm</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rule</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tableRule</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!--
  partitionCount: 各分片空间中节点的数量。格式是：m,n
  partitionLength: 每个分片空间中分配的范围大小。格式是：x,y
	计算公式是：m * x + n * y = 1024
	当前配置：1 * 256 + 1 * 768 = 1024
 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>function</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>partition-by-fixed-hash<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>io.mycat.route.function.PartitionByLong<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>partitionCount<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>1,1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>partitionLength<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>256,768<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>function</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><ol start="3"><li>测试，添加数据，可以发现数据会根据计算，落入相应的数据库节点。</li></ol> <p><img src="/code_heavy_industry/assets/img/img015.23a77744.png" alt="images"></p> <h3 id="_5-固定范围分片"><a href="#_5-固定范围分片" class="header-anchor">#</a> [5]固定范围分片</h3> <p><img src="/code_heavy_industry/assets/img/img016.2d5649c0.png" alt="images"></p> <p>该规则有点像枚举与固定hash的综合体，设置某一个字段，然后规定该字段值的不同范围值会进入到哪一个dataNode。适用于明确知道分片字段的某个范围属于某个分片</p> <p>优点：适用于想明确知道某个分片字段的某个范围具体在哪一个节点</p> <p>缺点：如果短时间内有大量的批量插入操作，那么某个分片节点可能一下子会承受比较大的数据库压力，而别的分片节点此时可能处于闲置状态，无法利用其它节点进行分担压力（热点数据问题)</p> <ol><li>修改<strong>schema.xml</strong>。</li></ol> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tb_user_range<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dataNode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dn129,dn130<span class="token punctuation">&quot;</span></span> <span class="token attr-name">primaryKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user_id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rule</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>auto-sharding-long<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="2"><li>修改<strong>rule.xml</strong></li></ol> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tableRule</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>auto-sharding-long<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>columns</span><span class="token punctuation">&gt;</span></span>age<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>columns</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>algorithm</span><span class="token punctuation">&gt;</span></span>rang-long<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>algorithm</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rule</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tableRule</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>修改<strong>autopartition-long.txt</strong>，定义自定义范围</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 用于定义 dataNode 对应的数据范围，如果配置多了会报错。
# range start-end ,data node index
# K=1000,M=10000.
#0-500M=0
#500M-1000M=1
#1000M-1500M=2

#所有的节点配置都是从0开始，0代表节点1
0-20=0
21-50=1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ol start="4"><li>测试，添加用户信息，年龄分别为9和33</li></ol> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>如果字段数据的值超过我们指定的范围，导致无法找到正确的 dataNode，会报错：</p> <p>can't find any valid datanode :T_EMP -&gt; EMP_AGE -&gt; 80</p> <p>此时如果 rule.xml 中配置了 defaultNode，则可以进入默认 dataNode。</p></div> <h3 id="_6-取模范围分片"><a href="#_6-取模范围分片" class="header-anchor">#</a> [6]取模范围分片</h3> <p>这种方式结合了范围分片和取模分片。工作机制：程序员指定一个字段，拿这个字段对一个指定的值取模。然后看这个模运算的结果在哪个区间，就去找对应区间的 dataNode。</p> <p>优点：可以自主决定取模后数据的节点分布</p> <p>缺点：dataNode 划分节点是事先建好的，需要扩展时比较麻烦</p> <ol><li>修改schema.xml，配置分片规则</li></ol> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tb_user_mod_range<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dataNode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dn129,dn130<span class="token punctuation">&quot;</span></span> <span class="token attr-name">primaryKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rule</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sharding-by-partition<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="2"><li>修改rule.xml，添加分片规则</li></ol> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tableRule</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sharding-by-partition<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>columns</span><span class="token punctuation">&gt;</span></span>user_id<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>columns</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>algorithm</span><span class="token punctuation">&gt;</span></span>sharding-by-partition<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>algorithm</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rule</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tableRule</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>function</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sharding-by-partition<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>io.mycat.route.function.PartitionByPattern<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--求模基数--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>patternValue<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>256<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--默认节点--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>defaultNode<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--指定规则配置文件--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mapFile<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>partition-pattern.txt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>function</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><ol start="3"><li>添加partition-pattern.txt，文件内部配置节点中数据范围</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>#0-128表示id%256后的数据范围。
0-128=0
129-256=1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="4"><li>测试</li></ol> <h3 id="_7-字符串hash分片"><a href="#_7-字符串hash分片" class="header-anchor">#</a> [7]字符串hash分片</h3> <p>在业务场景下，有时可能会根据某个分片字段的前几个值来进行取模。如地址信息只取省份、姓名只取前一个字的姓等。此时则可以使用该种方式。</p> <p>其工作方式与取模范围分片类似，该分片方式支持数值、符号、字母取模。</p> <p>执行流程大致是：字符串截取→hash操作→取模→根据指定范围选择 DataNode</p> <ol><li>修改schema.xml。</li></ol> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tb_user_string_hash<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dataNode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dn129,dn130<span class="token punctuation">&quot;</span></span> <span class="token attr-name">primaryKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user_id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rule</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sharding-by-string-hash<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="2"><li>修改rule.xml，定义拆分规则</li></ol> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tableRule</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sharding-by-string-hash<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>columns</span><span class="token punctuation">&gt;</span></span>user_name<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>columns</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>algorithm</span><span class="token punctuation">&gt;</span></span>sharding-by-string-hash-function<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>algorithm</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rule</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tableRule</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>function</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sharding-by-string-hash-function<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>io.mycat.route.function.PartitionByPrefixPattern<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--求模基数 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>patternValue<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>256<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 截取的位数  --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>prefixLength<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mapFile<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>partition-pattern-string-hash.txt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>function</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ol start="3"><li>新建partition-pattern-string-hash.txt。指定数据分片节点</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>0-128=0
129-256=1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>4）运行后可以发现 ，不同的姓名取模后，会进入不同的分片节点。</p> <h3 id="_8-一致性hash"><a href="#_8-一致性hash" class="header-anchor">#</a> [8]一致性hash</h3> <p>通过一致性hash分片可以最大限度的让数据均匀分布，但是均匀分布也会带来问题，就是分布式事务。</p> <p>原理是这样的：一致性hash算法引入了hash环的概念。环的大小是0~2^32-1。首先通过crc16算法计算出数据节点在hash环中的位置。</p> <p><img src="/code_heavy_industry/assets/img/image-20200614115947722.1b7d752a.png" alt=""></p> <p>当存储数据时，也会采用同样的算法，计算出数据key的hash值，映射到hash环上。</p> <p><img src="/code_heavy_industry/assets/img/image-20200614120302675.b6bc87d8.png" alt=""></p> <p>然后从数据映射的位置开始，以顺时针的方式找出距离最近的数据节点，接着将数据存入到该节点中。</p> <p><img src="/code_heavy_industry/assets/img/image-20200614121047323.eefee5f7.png" alt=""></p> <p>此时可以发现，数据并没有达到预期的数据均匀，可以发现如果两个数据节点在环上的距离，决定有大量数据存入了dataNode2，而仅有少量数据存入dataNode1。</p> <p>为了解决数据不均匀的问题，在mycat中可以设置<strong>虚拟数据映射节点</strong>。同时这些虚拟节点会映射到实际数据节点。</p> <p><img src="/code_heavy_industry/assets/img/image-20200614121729209.c44657f9.png" alt=""></p> <p>数据仍然以顺时针方式寻找数据节点，当找到最近的数据节点无论是实际还是虚拟，都会进行存储，如果是虚拟数据节点的话，最终会将数据保存到实际数据节点中。 从而尽量的使数据均匀分布。</p> <p>实现流程如下:</p> <ol><li><p>修改schema.xml</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tb_user_murmur<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dataNode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dn129,dn130<span class="token punctuation">&quot;</span></span> <span class="token attr-name">primaryKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user_id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rule</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sharding-by-murmur<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>修改rule.xml</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tableRule</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sharding-by-murmur<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>columns</span><span class="token punctuation">&gt;</span></span>user_id<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>columns</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>algorithm</span><span class="token punctuation">&gt;</span></span>murmur<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>algorithm</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rule</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tableRule</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>function</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>murmur<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>io.mycat.route.function.PartitionByMurmurHash<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token comment">&lt;!-- 默认是0即可 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>seed<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token comment">&lt;!-- 要分片的数据库节点数量，必须指定，否则没法分片 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>count<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token comment">&lt;!-- 一个实际的数据库节点被映射为这么多虚拟节点，默认是160倍，也就是虚拟节点数是物理节点数的160倍 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>virtualBucketTimes<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>160<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- &lt;property name=&quot;weightMapFile&quot;&gt;weightMapFile&lt;/property&gt; 节点的权重，没有指定权重的节点默认是1。以properties文件的格式填写，以从0开始到count-1的整数值也就是节点索引为key，以节点权重值为值。所有权重值必须是正整数，否则以1代替 --&gt;</span>
    
    <span class="token comment">&lt;!-- &lt;property name=&quot;bucketMapPath&quot;&gt;/etc/mycat/bucketMapPath&lt;/property&gt;
   用于测试时观察各物理节点与虚拟节点的分布情况，如果指定了这个属性，会把虚拟节点的murmur hash值与物理节点的映射按行输出到这个文件，没有默认值，如果不指定，就不会输出任何东西 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>function</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div></li> <li><p>测试: 循环插入一千条数据，数据会尽量均匀的分布在两个节点中。</p></li></ol> <h3 id="_9-时间分片"><a href="#_9-时间分片" class="header-anchor">#</a> [9]时间分片</h3> <p>当数据量非常大时，有时会考虑，按天去分库分表。这种场景是非常常见的。同时也有利于后期的数据查询。</p> <ol><li><p>修改schema.xml</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tb_user_day<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dataNode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dn129,dn130<span class="token punctuation">&quot;</span></span> <span class="token attr-name">primaryKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user_id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rule</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sharding-by-date<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>修改rule.xml，每十天一个分片，从起始时间开始计算，分片不够，则报错。</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tableRule</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sharding-by-date<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>columns</span><span class="token punctuation">&gt;</span></span>create_time<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>columns</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>algorithm</span><span class="token punctuation">&gt;</span></span>partbyday<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>algorithm</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rule</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tableRule</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>function</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>partbyday<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>io.mycat.route.function.PartitionByDate<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--日期格式--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dateFormat<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>yyyy-MM-dd<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sNaturalDay<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--从哪天开始,并且只能插入2020年的数据，2021的无法插入--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sBeginDate<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>2021-01-01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--每隔几天一个分片--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sPartionDay<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>function</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li> <li><p>测试: 当时间为1月1-10号之间，会进入129节点。当时间为11-20号之间，会进入130节点，当超出则报错。</p></li></ol> <h2 id="_4跨库join"><a href="#_4跨库join" class="header-anchor">#</a> ④跨库join</h2> <p>概念：A 表和 B 表做关联查询，但是 A 表和 B 表不在同一个数据库中。</p> <h3 id="_1-全局表"><a href="#_1-全局表" class="header-anchor">#</a> [1]全局表</h3> <p>系统中基本都会存在数据字典信息，如数据分类信息、项目的配置信息等。这些字典数据最大的特点就是数据量不大并且很少会被改变。同时绝大多数的业务场景都会涉及到字典表的操作。 因此为了避免频繁的跨库join操作，结合冗余数据思想，可以考虑把这些字典信息在每一个分库中都存在一份。</p> <p>mycat在进行join操作时，当业务表与全局表进行聚合会优先选择相同分片的全局表，从而避免跨库join操作。在进行数据插入时，会把数据同时插入到所有分片的全局表中。</p> <p>1）修改<strong>schema.xml</strong></p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tb_global<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dataNode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dn142,dn145<span class="token punctuation">&quot;</span></span> <span class="token attr-name">primaryKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>global_id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>global<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_2-er表"><a href="#_2-er表" class="header-anchor">#</a> [2]ER表</h3> <p>ER表也是一种为了避免跨库join的手段，在业务开发时，经常会使用到主从表关系的查询，如商品表与商品详情表。</p> <p>ER表的出现就是为了让有关系的表数据存储于同一个分片中，从而避免跨库join的出现。</p> <ol><li>修改schema.xml</li></ol> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tb_goods<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dataNode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dn129,dn130<span class="token punctuation">&quot;</span></span> <span class="token attr-name">primaryKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>goods_id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rule</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sharding-by-murmur-goods<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>childTable</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tb_goods_detail<span class="token punctuation">&quot;</span></span> <span class="token attr-name">primaryKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>goods_detail_id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">joinKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>goods_id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">parentKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>goods_id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>childTable</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="2"><li>再次添加goods数据的时候,有关系的表数据存储于同一个分片中</li></ol> <p><a href="/code_heavy_industry/pro018-MySQL-high/lecture/chapter10/index.html">上一章</a> <a href="/code_heavy_industry/pro018-MySQL-high/lecture/index.html">回目录</a> <a href="/code_heavy_industry/pro018-MySQL-high/lecture/chapter11/temple-mycat/index.html">下一章</a></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/code_heavy_industry/assets/js/app.7f9743ec.js" defer></script><script src="/code_heavy_industry/assets/js/3.8b9ff05a.js" defer></script><script src="/code_heavy_industry/assets/js/6.a2844d61.js" defer></script>
  </body>
</html>
