<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>代码重工</title>
    <meta name="generator" content="VuePress 1.9.5">
    
    <meta name="description" content="代码重工">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.3e0017e1.js" as="script"><link rel="preload" href="/assets/js/3.20041f1c.js" as="script"><link rel="preload" href="/assets/js/57.08a9b0c8.js" as="script"><link rel="prefetch" href="/assets/js/10.ba17889a.js"><link rel="prefetch" href="/assets/js/100.7af4c3fc.js"><link rel="prefetch" href="/assets/js/101.7b5f6bd3.js"><link rel="prefetch" href="/assets/js/102.7cfbe0f1.js"><link rel="prefetch" href="/assets/js/103.dea9b9fb.js"><link rel="prefetch" href="/assets/js/104.d777fb50.js"><link rel="prefetch" href="/assets/js/105.5ef4e706.js"><link rel="prefetch" href="/assets/js/106.ea71b142.js"><link rel="prefetch" href="/assets/js/107.dd67843f.js"><link rel="prefetch" href="/assets/js/108.b7aa80b7.js"><link rel="prefetch" href="/assets/js/109.090b28ea.js"><link rel="prefetch" href="/assets/js/11.31a56c42.js"><link rel="prefetch" href="/assets/js/110.f8a9f3e0.js"><link rel="prefetch" href="/assets/js/111.ca2dd2c7.js"><link rel="prefetch" href="/assets/js/112.a66d0163.js"><link rel="prefetch" href="/assets/js/113.1089e092.js"><link rel="prefetch" href="/assets/js/114.4eea7ff7.js"><link rel="prefetch" href="/assets/js/115.e8c08b09.js"><link rel="prefetch" href="/assets/js/116.bccea497.js"><link rel="prefetch" href="/assets/js/117.a72225e9.js"><link rel="prefetch" href="/assets/js/118.8e05ab58.js"><link rel="prefetch" href="/assets/js/119.de0b0dab.js"><link rel="prefetch" href="/assets/js/12.0b071af4.js"><link rel="prefetch" href="/assets/js/120.3faad76c.js"><link rel="prefetch" href="/assets/js/121.8747aa10.js"><link rel="prefetch" href="/assets/js/122.847e1e23.js"><link rel="prefetch" href="/assets/js/123.8f9716de.js"><link rel="prefetch" href="/assets/js/124.1daef88a.js"><link rel="prefetch" href="/assets/js/125.01197995.js"><link rel="prefetch" href="/assets/js/126.21655809.js"><link rel="prefetch" href="/assets/js/127.a04a3807.js"><link rel="prefetch" href="/assets/js/128.7f989c74.js"><link rel="prefetch" href="/assets/js/129.173ff4d5.js"><link rel="prefetch" href="/assets/js/13.c61a0d81.js"><link rel="prefetch" href="/assets/js/130.82f19172.js"><link rel="prefetch" href="/assets/js/131.fab29fe1.js"><link rel="prefetch" href="/assets/js/132.b10e6858.js"><link rel="prefetch" href="/assets/js/133.08dc971f.js"><link rel="prefetch" href="/assets/js/134.6f205f35.js"><link rel="prefetch" href="/assets/js/135.3193233d.js"><link rel="prefetch" href="/assets/js/136.ca5b620e.js"><link rel="prefetch" href="/assets/js/137.04c4828b.js"><link rel="prefetch" href="/assets/js/138.9788004e.js"><link rel="prefetch" href="/assets/js/139.1f235d13.js"><link rel="prefetch" href="/assets/js/14.4b633789.js"><link rel="prefetch" href="/assets/js/140.0134fa2a.js"><link rel="prefetch" href="/assets/js/141.3c4cb1d1.js"><link rel="prefetch" href="/assets/js/142.e333f6b7.js"><link rel="prefetch" href="/assets/js/143.af136465.js"><link rel="prefetch" href="/assets/js/144.5fa51468.js"><link rel="prefetch" href="/assets/js/145.b4cafe89.js"><link rel="prefetch" href="/assets/js/146.5d625332.js"><link rel="prefetch" href="/assets/js/147.4f6ffcfd.js"><link rel="prefetch" href="/assets/js/148.ba983ce0.js"><link rel="prefetch" href="/assets/js/149.0a077866.js"><link rel="prefetch" href="/assets/js/15.5277393d.js"><link rel="prefetch" href="/assets/js/150.6965d099.js"><link rel="prefetch" href="/assets/js/151.0f20ebf2.js"><link rel="prefetch" href="/assets/js/152.fd8b817d.js"><link rel="prefetch" href="/assets/js/153.4746f37f.js"><link rel="prefetch" href="/assets/js/154.2e431003.js"><link rel="prefetch" href="/assets/js/155.e1c8cc51.js"><link rel="prefetch" href="/assets/js/156.32c500f0.js"><link rel="prefetch" href="/assets/js/157.950ba84b.js"><link rel="prefetch" href="/assets/js/158.9dbf2e0b.js"><link rel="prefetch" href="/assets/js/159.02034c4a.js"><link rel="prefetch" href="/assets/js/16.f12e8b9a.js"><link rel="prefetch" href="/assets/js/160.e06ec53d.js"><link rel="prefetch" href="/assets/js/161.48be28ea.js"><link rel="prefetch" href="/assets/js/162.cb5d3f57.js"><link rel="prefetch" href="/assets/js/163.e7b26f3e.js"><link rel="prefetch" href="/assets/js/164.c6a2ddee.js"><link rel="prefetch" href="/assets/js/165.298b7e33.js"><link rel="prefetch" href="/assets/js/166.ddad1bce.js"><link rel="prefetch" href="/assets/js/167.b2b8258f.js"><link rel="prefetch" href="/assets/js/168.38f9f54c.js"><link rel="prefetch" href="/assets/js/169.0069bcde.js"><link rel="prefetch" href="/assets/js/17.680669a5.js"><link rel="prefetch" href="/assets/js/170.1dd7e32a.js"><link rel="prefetch" href="/assets/js/171.de3c68d7.js"><link rel="prefetch" href="/assets/js/172.30efeb65.js"><link rel="prefetch" href="/assets/js/173.d7ebac4a.js"><link rel="prefetch" href="/assets/js/174.a0239e0f.js"><link rel="prefetch" href="/assets/js/175.0a424a0c.js"><link rel="prefetch" href="/assets/js/176.cef47ce3.js"><link rel="prefetch" href="/assets/js/177.b0788e43.js"><link rel="prefetch" href="/assets/js/178.7869e9c7.js"><link rel="prefetch" href="/assets/js/179.dad9755f.js"><link rel="prefetch" href="/assets/js/18.067352ef.js"><link rel="prefetch" href="/assets/js/180.55790e2f.js"><link rel="prefetch" href="/assets/js/181.b485da02.js"><link rel="prefetch" href="/assets/js/182.e2f485fe.js"><link rel="prefetch" href="/assets/js/183.e9fe6ab7.js"><link rel="prefetch" href="/assets/js/184.953b793e.js"><link rel="prefetch" href="/assets/js/185.01a61814.js"><link rel="prefetch" href="/assets/js/186.5c2db156.js"><link rel="prefetch" href="/assets/js/187.6580e8f5.js"><link rel="prefetch" href="/assets/js/188.77ea4479.js"><link rel="prefetch" href="/assets/js/189.9308c237.js"><link rel="prefetch" href="/assets/js/19.fce5d6e0.js"><link rel="prefetch" href="/assets/js/190.e4e7221a.js"><link rel="prefetch" href="/assets/js/191.86c1a8b3.js"><link rel="prefetch" href="/assets/js/192.f3214e57.js"><link rel="prefetch" href="/assets/js/193.aed69271.js"><link rel="prefetch" href="/assets/js/194.01e8f5cf.js"><link rel="prefetch" href="/assets/js/195.dad1c855.js"><link rel="prefetch" href="/assets/js/196.acf0c88e.js"><link rel="prefetch" href="/assets/js/197.d36ce9c0.js"><link rel="prefetch" href="/assets/js/198.1563a487.js"><link rel="prefetch" href="/assets/js/199.38d39c78.js"><link rel="prefetch" href="/assets/js/2.52bd1d1a.js"><link rel="prefetch" href="/assets/js/20.59039e3a.js"><link rel="prefetch" href="/assets/js/200.494b0d3b.js"><link rel="prefetch" href="/assets/js/201.bd9fde8a.js"><link rel="prefetch" href="/assets/js/202.4a192501.js"><link rel="prefetch" href="/assets/js/203.d0fdd98f.js"><link rel="prefetch" href="/assets/js/204.a32ee0b5.js"><link rel="prefetch" href="/assets/js/205.5c606d21.js"><link rel="prefetch" href="/assets/js/206.0429c555.js"><link rel="prefetch" href="/assets/js/207.b9786984.js"><link rel="prefetch" href="/assets/js/208.84a6b22a.js"><link rel="prefetch" href="/assets/js/209.b1567278.js"><link rel="prefetch" href="/assets/js/21.95e2acf2.js"><link rel="prefetch" href="/assets/js/210.cb46e66e.js"><link rel="prefetch" href="/assets/js/211.7cd29852.js"><link rel="prefetch" href="/assets/js/212.c5984846.js"><link rel="prefetch" href="/assets/js/213.032652ec.js"><link rel="prefetch" href="/assets/js/214.f3c05896.js"><link rel="prefetch" href="/assets/js/215.85f54346.js"><link rel="prefetch" href="/assets/js/216.5859022b.js"><link rel="prefetch" href="/assets/js/217.d1c96eff.js"><link rel="prefetch" href="/assets/js/218.3a7102c0.js"><link rel="prefetch" href="/assets/js/219.446bf804.js"><link rel="prefetch" href="/assets/js/22.7f461c59.js"><link rel="prefetch" href="/assets/js/220.82678d02.js"><link rel="prefetch" href="/assets/js/221.5b841197.js"><link rel="prefetch" href="/assets/js/222.5a25690b.js"><link rel="prefetch" href="/assets/js/223.db4ba490.js"><link rel="prefetch" href="/assets/js/224.d8ef7c30.js"><link rel="prefetch" href="/assets/js/225.12e4900c.js"><link rel="prefetch" href="/assets/js/226.80a96845.js"><link rel="prefetch" href="/assets/js/227.72e11742.js"><link rel="prefetch" href="/assets/js/228.2b6f0415.js"><link rel="prefetch" href="/assets/js/229.9f80f3a2.js"><link rel="prefetch" href="/assets/js/23.630e7382.js"><link rel="prefetch" href="/assets/js/230.d6f9ee86.js"><link rel="prefetch" href="/assets/js/231.63a56018.js"><link rel="prefetch" href="/assets/js/232.5512a215.js"><link rel="prefetch" href="/assets/js/233.779ad086.js"><link rel="prefetch" href="/assets/js/234.64f974cb.js"><link rel="prefetch" href="/assets/js/235.7088ef71.js"><link rel="prefetch" href="/assets/js/236.54bb2870.js"><link rel="prefetch" href="/assets/js/237.e491049b.js"><link rel="prefetch" href="/assets/js/238.9a8f6d9f.js"><link rel="prefetch" href="/assets/js/239.744f038b.js"><link rel="prefetch" href="/assets/js/24.c36d5d2d.js"><link rel="prefetch" href="/assets/js/240.e462c5bd.js"><link rel="prefetch" href="/assets/js/241.69defe66.js"><link rel="prefetch" href="/assets/js/242.8ce4bc70.js"><link rel="prefetch" href="/assets/js/243.6ac1d0b8.js"><link rel="prefetch" href="/assets/js/244.12b0184e.js"><link rel="prefetch" href="/assets/js/245.5579e044.js"><link rel="prefetch" href="/assets/js/246.b3d549ac.js"><link rel="prefetch" href="/assets/js/247.0c54718f.js"><link rel="prefetch" href="/assets/js/248.44c4b1d5.js"><link rel="prefetch" href="/assets/js/249.8d045b79.js"><link rel="prefetch" href="/assets/js/25.ccd2a68b.js"><link rel="prefetch" href="/assets/js/250.e005cdb1.js"><link rel="prefetch" href="/assets/js/251.cdc19fe9.js"><link rel="prefetch" href="/assets/js/252.4eb44d11.js"><link rel="prefetch" href="/assets/js/253.aa85ce41.js"><link rel="prefetch" href="/assets/js/254.364d08bf.js"><link rel="prefetch" href="/assets/js/255.b7e7efa9.js"><link rel="prefetch" href="/assets/js/256.177d24ad.js"><link rel="prefetch" href="/assets/js/257.8fb48303.js"><link rel="prefetch" href="/assets/js/258.0e7346b6.js"><link rel="prefetch" href="/assets/js/259.de3f9b89.js"><link rel="prefetch" href="/assets/js/26.a4fcb1fc.js"><link rel="prefetch" href="/assets/js/260.2293ea0a.js"><link rel="prefetch" href="/assets/js/261.182484da.js"><link rel="prefetch" href="/assets/js/262.414a8b8d.js"><link rel="prefetch" href="/assets/js/263.69f599be.js"><link rel="prefetch" href="/assets/js/264.131e8203.js"><link rel="prefetch" href="/assets/js/265.6d758dd9.js"><link rel="prefetch" href="/assets/js/266.3d45f210.js"><link rel="prefetch" href="/assets/js/267.290b03ac.js"><link rel="prefetch" href="/assets/js/268.4e9378fa.js"><link rel="prefetch" href="/assets/js/269.7960b976.js"><link rel="prefetch" href="/assets/js/27.df3d86d0.js"><link rel="prefetch" href="/assets/js/270.24112558.js"><link rel="prefetch" href="/assets/js/271.c947aecf.js"><link rel="prefetch" href="/assets/js/272.f5d45a4e.js"><link rel="prefetch" href="/assets/js/273.5c896b7d.js"><link rel="prefetch" href="/assets/js/274.f6b7bcbc.js"><link rel="prefetch" href="/assets/js/275.828ed1dc.js"><link rel="prefetch" href="/assets/js/276.7e86f680.js"><link rel="prefetch" href="/assets/js/277.8989fae4.js"><link rel="prefetch" href="/assets/js/278.5bb6625e.js"><link rel="prefetch" href="/assets/js/279.9c207b7d.js"><link rel="prefetch" href="/assets/js/28.8bcc7469.js"><link rel="prefetch" href="/assets/js/280.893cef33.js"><link rel="prefetch" href="/assets/js/281.bbbac5b8.js"><link rel="prefetch" href="/assets/js/282.93312000.js"><link rel="prefetch" href="/assets/js/283.72c1a513.js"><link rel="prefetch" href="/assets/js/284.cd9f95c1.js"><link rel="prefetch" href="/assets/js/285.b5fdd306.js"><link rel="prefetch" href="/assets/js/286.f1f65c17.js"><link rel="prefetch" href="/assets/js/287.0d4d2a77.js"><link rel="prefetch" href="/assets/js/288.e9e4792b.js"><link rel="prefetch" href="/assets/js/289.343aef1e.js"><link rel="prefetch" href="/assets/js/29.266a69d7.js"><link rel="prefetch" href="/assets/js/290.c0779ee2.js"><link rel="prefetch" href="/assets/js/291.c1089e23.js"><link rel="prefetch" href="/assets/js/292.1371d3c1.js"><link rel="prefetch" href="/assets/js/293.4e7321ce.js"><link rel="prefetch" href="/assets/js/294.bd641acf.js"><link rel="prefetch" href="/assets/js/295.e7b706ac.js"><link rel="prefetch" href="/assets/js/296.7ee9038f.js"><link rel="prefetch" href="/assets/js/297.95c704d7.js"><link rel="prefetch" href="/assets/js/298.c9cd9c8d.js"><link rel="prefetch" href="/assets/js/299.08a1dddd.js"><link rel="prefetch" href="/assets/js/30.efd5b848.js"><link rel="prefetch" href="/assets/js/300.4f9012b7.js"><link rel="prefetch" href="/assets/js/301.4d04fe4e.js"><link rel="prefetch" href="/assets/js/302.ebec0148.js"><link rel="prefetch" href="/assets/js/303.676d0999.js"><link rel="prefetch" href="/assets/js/304.75890d01.js"><link rel="prefetch" href="/assets/js/305.9a9a7665.js"><link rel="prefetch" href="/assets/js/306.fb06d7dd.js"><link rel="prefetch" href="/assets/js/307.e2e9eda7.js"><link rel="prefetch" href="/assets/js/308.352f9bb2.js"><link rel="prefetch" href="/assets/js/309.35fce99c.js"><link rel="prefetch" href="/assets/js/31.b52b8bb5.js"><link rel="prefetch" href="/assets/js/310.7d3a2f8e.js"><link rel="prefetch" href="/assets/js/311.4bd59f87.js"><link rel="prefetch" href="/assets/js/312.21580a7b.js"><link rel="prefetch" href="/assets/js/313.c48ce593.js"><link rel="prefetch" href="/assets/js/314.9e05a3ab.js"><link rel="prefetch" href="/assets/js/315.c4748289.js"><link rel="prefetch" href="/assets/js/316.25f39c84.js"><link rel="prefetch" href="/assets/js/317.00492ed6.js"><link rel="prefetch" href="/assets/js/318.e44dda49.js"><link rel="prefetch" href="/assets/js/319.d220d464.js"><link rel="prefetch" href="/assets/js/32.16c1241f.js"><link rel="prefetch" href="/assets/js/320.3f7d356e.js"><link rel="prefetch" href="/assets/js/321.e6c3c581.js"><link rel="prefetch" href="/assets/js/322.4acf3ea3.js"><link rel="prefetch" href="/assets/js/323.1b81c050.js"><link rel="prefetch" href="/assets/js/324.e261d490.js"><link rel="prefetch" href="/assets/js/325.f431b898.js"><link rel="prefetch" href="/assets/js/326.70c1ae90.js"><link rel="prefetch" href="/assets/js/327.06210ca2.js"><link rel="prefetch" href="/assets/js/328.c6aac359.js"><link rel="prefetch" href="/assets/js/329.1cac0f03.js"><link rel="prefetch" href="/assets/js/33.9297b23e.js"><link rel="prefetch" href="/assets/js/330.dddcd4e3.js"><link rel="prefetch" href="/assets/js/331.57490eb3.js"><link rel="prefetch" href="/assets/js/332.0732349d.js"><link rel="prefetch" href="/assets/js/333.a1140f60.js"><link rel="prefetch" href="/assets/js/334.db92b37d.js"><link rel="prefetch" href="/assets/js/335.1b952c3f.js"><link rel="prefetch" href="/assets/js/336.35c5e15a.js"><link rel="prefetch" href="/assets/js/337.3f6e7e38.js"><link rel="prefetch" href="/assets/js/338.b893ccb3.js"><link rel="prefetch" href="/assets/js/339.6fb5fc61.js"><link rel="prefetch" href="/assets/js/34.737eeb80.js"><link rel="prefetch" href="/assets/js/340.8c561d43.js"><link rel="prefetch" href="/assets/js/341.c2060cdd.js"><link rel="prefetch" href="/assets/js/342.1a47c3e7.js"><link rel="prefetch" href="/assets/js/343.8af4ced4.js"><link rel="prefetch" href="/assets/js/344.305cbea2.js"><link rel="prefetch" href="/assets/js/345.a2581a75.js"><link rel="prefetch" href="/assets/js/346.aed0d958.js"><link rel="prefetch" href="/assets/js/347.b88ad6c7.js"><link rel="prefetch" href="/assets/js/348.e81b3e61.js"><link rel="prefetch" href="/assets/js/349.3be74058.js"><link rel="prefetch" href="/assets/js/35.9ceb2124.js"><link rel="prefetch" href="/assets/js/350.cb4ec4f8.js"><link rel="prefetch" href="/assets/js/351.8e89d877.js"><link rel="prefetch" href="/assets/js/352.baa06289.js"><link rel="prefetch" href="/assets/js/353.bf1282da.js"><link rel="prefetch" href="/assets/js/354.a4286ab4.js"><link rel="prefetch" href="/assets/js/355.11bcd8c6.js"><link rel="prefetch" href="/assets/js/356.729bc929.js"><link rel="prefetch" href="/assets/js/357.30508fb4.js"><link rel="prefetch" href="/assets/js/358.e163968d.js"><link rel="prefetch" href="/assets/js/359.02b8374b.js"><link rel="prefetch" href="/assets/js/36.95ddf04d.js"><link rel="prefetch" href="/assets/js/360.04a7e155.js"><link rel="prefetch" href="/assets/js/361.5c80bf79.js"><link rel="prefetch" href="/assets/js/362.3ab05355.js"><link rel="prefetch" href="/assets/js/363.7c5b8b19.js"><link rel="prefetch" href="/assets/js/364.86a18eeb.js"><link rel="prefetch" href="/assets/js/365.0a06032e.js"><link rel="prefetch" href="/assets/js/366.2977d1c1.js"><link rel="prefetch" href="/assets/js/367.591fc58a.js"><link rel="prefetch" href="/assets/js/368.24d67953.js"><link rel="prefetch" href="/assets/js/369.17f93d9e.js"><link rel="prefetch" href="/assets/js/37.fc41a38b.js"><link rel="prefetch" href="/assets/js/370.172eecd7.js"><link rel="prefetch" href="/assets/js/371.6d67a7b7.js"><link rel="prefetch" href="/assets/js/372.e715b468.js"><link rel="prefetch" href="/assets/js/373.af23e329.js"><link rel="prefetch" href="/assets/js/374.2da2b4a8.js"><link rel="prefetch" href="/assets/js/375.8cf80d6f.js"><link rel="prefetch" href="/assets/js/376.128245a9.js"><link rel="prefetch" href="/assets/js/377.86112bd9.js"><link rel="prefetch" href="/assets/js/378.6dade376.js"><link rel="prefetch" href="/assets/js/379.7e75abf5.js"><link rel="prefetch" href="/assets/js/38.4def8a64.js"><link rel="prefetch" href="/assets/js/380.960c097b.js"><link rel="prefetch" href="/assets/js/381.1fe51ea6.js"><link rel="prefetch" href="/assets/js/382.6a4b94b9.js"><link rel="prefetch" href="/assets/js/383.4538778f.js"><link rel="prefetch" href="/assets/js/384.673680e2.js"><link rel="prefetch" href="/assets/js/385.183809d1.js"><link rel="prefetch" href="/assets/js/386.b94ca064.js"><link rel="prefetch" href="/assets/js/387.c7aa3fb3.js"><link rel="prefetch" href="/assets/js/388.60feb0ad.js"><link rel="prefetch" href="/assets/js/389.27e5cc64.js"><link rel="prefetch" href="/assets/js/39.1e430d16.js"><link rel="prefetch" href="/assets/js/390.c00c333b.js"><link rel="prefetch" href="/assets/js/391.35d480d7.js"><link rel="prefetch" href="/assets/js/392.0a28217b.js"><link rel="prefetch" href="/assets/js/393.6c44779a.js"><link rel="prefetch" href="/assets/js/394.85c32eaf.js"><link rel="prefetch" href="/assets/js/395.9d04857a.js"><link rel="prefetch" href="/assets/js/396.0b5ff238.js"><link rel="prefetch" href="/assets/js/397.fe39d6a8.js"><link rel="prefetch" href="/assets/js/398.cd409dd1.js"><link rel="prefetch" href="/assets/js/399.e84ddfb1.js"><link rel="prefetch" href="/assets/js/4.7855e7e9.js"><link rel="prefetch" href="/assets/js/40.35191bba.js"><link rel="prefetch" href="/assets/js/400.d6f0857c.js"><link rel="prefetch" href="/assets/js/401.87216d22.js"><link rel="prefetch" href="/assets/js/402.a40c4159.js"><link rel="prefetch" href="/assets/js/403.d0b242bf.js"><link rel="prefetch" href="/assets/js/404.c4af12a5.js"><link rel="prefetch" href="/assets/js/405.b70aa2eb.js"><link rel="prefetch" href="/assets/js/406.8452c09f.js"><link rel="prefetch" href="/assets/js/407.90afc38d.js"><link rel="prefetch" href="/assets/js/408.11cba5bc.js"><link rel="prefetch" href="/assets/js/409.38b06116.js"><link rel="prefetch" href="/assets/js/41.9813aa99.js"><link rel="prefetch" href="/assets/js/410.11b6c31e.js"><link rel="prefetch" href="/assets/js/411.c162f9ab.js"><link rel="prefetch" href="/assets/js/412.e55cf018.js"><link rel="prefetch" href="/assets/js/413.6647d51a.js"><link rel="prefetch" href="/assets/js/414.25751bce.js"><link rel="prefetch" href="/assets/js/415.56be62e4.js"><link rel="prefetch" href="/assets/js/416.cac42dd8.js"><link rel="prefetch" href="/assets/js/417.cf0a7b14.js"><link rel="prefetch" href="/assets/js/418.c9659787.js"><link rel="prefetch" href="/assets/js/419.f8b9094a.js"><link rel="prefetch" href="/assets/js/42.7e6302fb.js"><link rel="prefetch" href="/assets/js/420.cbbcc8f5.js"><link rel="prefetch" href="/assets/js/421.1f25a039.js"><link rel="prefetch" href="/assets/js/422.5730a186.js"><link rel="prefetch" href="/assets/js/423.32fd52e7.js"><link rel="prefetch" href="/assets/js/424.40e11543.js"><link rel="prefetch" href="/assets/js/425.5fdf84bc.js"><link rel="prefetch" href="/assets/js/426.d1cd2ecc.js"><link rel="prefetch" href="/assets/js/427.a80c84ae.js"><link rel="prefetch" href="/assets/js/428.57c88393.js"><link rel="prefetch" href="/assets/js/429.a6fa508a.js"><link rel="prefetch" href="/assets/js/43.b3d210b6.js"><link rel="prefetch" href="/assets/js/430.22a8ac07.js"><link rel="prefetch" href="/assets/js/431.b7bf1059.js"><link rel="prefetch" href="/assets/js/432.23e2e2de.js"><link rel="prefetch" href="/assets/js/433.967e2d49.js"><link rel="prefetch" href="/assets/js/434.700fc48e.js"><link rel="prefetch" href="/assets/js/435.1f2ecb17.js"><link rel="prefetch" href="/assets/js/436.d11e1875.js"><link rel="prefetch" href="/assets/js/437.0921b5fc.js"><link rel="prefetch" href="/assets/js/438.afda800e.js"><link rel="prefetch" href="/assets/js/439.87e4f0b5.js"><link rel="prefetch" href="/assets/js/44.d7bbc2cc.js"><link rel="prefetch" href="/assets/js/440.9ff5eb6c.js"><link rel="prefetch" href="/assets/js/441.062de7a0.js"><link rel="prefetch" href="/assets/js/442.767dc3ec.js"><link rel="prefetch" href="/assets/js/443.0f13aa59.js"><link rel="prefetch" href="/assets/js/444.f490bd91.js"><link rel="prefetch" href="/assets/js/445.2930e7af.js"><link rel="prefetch" href="/assets/js/446.3e9b9299.js"><link rel="prefetch" href="/assets/js/447.bc18c40b.js"><link rel="prefetch" href="/assets/js/448.03a0d8a1.js"><link rel="prefetch" href="/assets/js/449.6cabda30.js"><link rel="prefetch" href="/assets/js/45.0673c7d4.js"><link rel="prefetch" href="/assets/js/450.98ab4ed6.js"><link rel="prefetch" href="/assets/js/451.0379c2b3.js"><link rel="prefetch" href="/assets/js/452.e2c959f5.js"><link rel="prefetch" href="/assets/js/453.81e7aea0.js"><link rel="prefetch" href="/assets/js/454.8313c42e.js"><link rel="prefetch" href="/assets/js/455.6f120b91.js"><link rel="prefetch" href="/assets/js/456.426d33ca.js"><link rel="prefetch" href="/assets/js/457.84d89786.js"><link rel="prefetch" href="/assets/js/458.7df95eaf.js"><link rel="prefetch" href="/assets/js/459.09a7bd4a.js"><link rel="prefetch" href="/assets/js/46.86c5dd94.js"><link rel="prefetch" href="/assets/js/460.048237ef.js"><link rel="prefetch" href="/assets/js/461.1b505cdc.js"><link rel="prefetch" href="/assets/js/462.60884b82.js"><link rel="prefetch" href="/assets/js/463.2fa8ab37.js"><link rel="prefetch" href="/assets/js/464.b0c40563.js"><link rel="prefetch" href="/assets/js/465.e13e3130.js"><link rel="prefetch" href="/assets/js/466.202bc632.js"><link rel="prefetch" href="/assets/js/467.f1fdab4b.js"><link rel="prefetch" href="/assets/js/468.2cfea1f7.js"><link rel="prefetch" href="/assets/js/469.e291e0ca.js"><link rel="prefetch" href="/assets/js/47.1d9310c8.js"><link rel="prefetch" href="/assets/js/470.851297be.js"><link rel="prefetch" href="/assets/js/471.4e05c77e.js"><link rel="prefetch" href="/assets/js/472.f57bf98d.js"><link rel="prefetch" href="/assets/js/473.101af25d.js"><link rel="prefetch" href="/assets/js/474.7723d605.js"><link rel="prefetch" href="/assets/js/475.860a4488.js"><link rel="prefetch" href="/assets/js/476.eb9f22a9.js"><link rel="prefetch" href="/assets/js/477.d102f07a.js"><link rel="prefetch" href="/assets/js/478.8850975b.js"><link rel="prefetch" href="/assets/js/479.d5221e07.js"><link rel="prefetch" href="/assets/js/48.1a8a7488.js"><link rel="prefetch" href="/assets/js/480.7997002a.js"><link rel="prefetch" href="/assets/js/481.7bf42631.js"><link rel="prefetch" href="/assets/js/482.3be13db3.js"><link rel="prefetch" href="/assets/js/483.5598a151.js"><link rel="prefetch" href="/assets/js/484.0f178635.js"><link rel="prefetch" href="/assets/js/485.a19fbce2.js"><link rel="prefetch" href="/assets/js/486.f69227af.js"><link rel="prefetch" href="/assets/js/487.cc25de7f.js"><link rel="prefetch" href="/assets/js/488.44c3cb33.js"><link rel="prefetch" href="/assets/js/489.79e562cb.js"><link rel="prefetch" href="/assets/js/49.941c4796.js"><link rel="prefetch" href="/assets/js/490.822244e8.js"><link rel="prefetch" href="/assets/js/491.31cf2236.js"><link rel="prefetch" href="/assets/js/492.fcb0c57d.js"><link rel="prefetch" href="/assets/js/493.7625900d.js"><link rel="prefetch" href="/assets/js/494.430899d2.js"><link rel="prefetch" href="/assets/js/495.23158cae.js"><link rel="prefetch" href="/assets/js/496.6c196249.js"><link rel="prefetch" href="/assets/js/497.4dfdc0eb.js"><link rel="prefetch" href="/assets/js/498.95223896.js"><link rel="prefetch" href="/assets/js/499.debce1ba.js"><link rel="prefetch" href="/assets/js/5.9e16194b.js"><link rel="prefetch" href="/assets/js/50.753d707f.js"><link rel="prefetch" href="/assets/js/500.e5b12559.js"><link rel="prefetch" href="/assets/js/501.d17f82b3.js"><link rel="prefetch" href="/assets/js/502.716d7fb1.js"><link rel="prefetch" href="/assets/js/503.352b1cbf.js"><link rel="prefetch" href="/assets/js/504.1115c22b.js"><link rel="prefetch" href="/assets/js/505.165f9b3c.js"><link rel="prefetch" href="/assets/js/506.eddc3a98.js"><link rel="prefetch" href="/assets/js/507.f66a2256.js"><link rel="prefetch" href="/assets/js/508.b0662ef0.js"><link rel="prefetch" href="/assets/js/509.9f2e4965.js"><link rel="prefetch" href="/assets/js/51.2a11a0d2.js"><link rel="prefetch" href="/assets/js/510.7c3566a5.js"><link rel="prefetch" href="/assets/js/511.39c82955.js"><link rel="prefetch" href="/assets/js/512.9a624d19.js"><link rel="prefetch" href="/assets/js/513.03c2dc87.js"><link rel="prefetch" href="/assets/js/514.1f1675f3.js"><link rel="prefetch" href="/assets/js/515.157ea32d.js"><link rel="prefetch" href="/assets/js/516.0eb8f3f4.js"><link rel="prefetch" href="/assets/js/517.40a3ed86.js"><link rel="prefetch" href="/assets/js/518.3e0ab003.js"><link rel="prefetch" href="/assets/js/519.2a8c65a6.js"><link rel="prefetch" href="/assets/js/52.9b95f3bd.js"><link rel="prefetch" href="/assets/js/520.2312b57d.js"><link rel="prefetch" href="/assets/js/521.381ebc9e.js"><link rel="prefetch" href="/assets/js/522.ae8b858e.js"><link rel="prefetch" href="/assets/js/523.99e8750d.js"><link rel="prefetch" href="/assets/js/524.4911b0e2.js"><link rel="prefetch" href="/assets/js/525.90aa98ef.js"><link rel="prefetch" href="/assets/js/526.0274b468.js"><link rel="prefetch" href="/assets/js/527.deab4258.js"><link rel="prefetch" href="/assets/js/528.4a67f406.js"><link rel="prefetch" href="/assets/js/529.91cc81aa.js"><link rel="prefetch" href="/assets/js/53.ee90a42f.js"><link rel="prefetch" href="/assets/js/530.cc1635b2.js"><link rel="prefetch" href="/assets/js/531.475ac611.js"><link rel="prefetch" href="/assets/js/532.8ffc9ea2.js"><link rel="prefetch" href="/assets/js/533.35efbf66.js"><link rel="prefetch" href="/assets/js/534.d35cf66d.js"><link rel="prefetch" href="/assets/js/535.9eecee09.js"><link rel="prefetch" href="/assets/js/536.058e2669.js"><link rel="prefetch" href="/assets/js/537.881b9b94.js"><link rel="prefetch" href="/assets/js/538.0c3becf8.js"><link rel="prefetch" href="/assets/js/539.c01ddc0c.js"><link rel="prefetch" href="/assets/js/54.a406277e.js"><link rel="prefetch" href="/assets/js/540.a5a841a4.js"><link rel="prefetch" href="/assets/js/541.19ffb499.js"><link rel="prefetch" href="/assets/js/542.0f5f5a6d.js"><link rel="prefetch" href="/assets/js/543.1ee226fa.js"><link rel="prefetch" href="/assets/js/544.66798ad8.js"><link rel="prefetch" href="/assets/js/545.44a935d2.js"><link rel="prefetch" href="/assets/js/546.e410ae42.js"><link rel="prefetch" href="/assets/js/547.cffa908e.js"><link rel="prefetch" href="/assets/js/548.f9e833ca.js"><link rel="prefetch" href="/assets/js/549.13799b79.js"><link rel="prefetch" href="/assets/js/55.b912e382.js"><link rel="prefetch" href="/assets/js/550.4a930e83.js"><link rel="prefetch" href="/assets/js/551.1140671f.js"><link rel="prefetch" href="/assets/js/552.23f5848f.js"><link rel="prefetch" href="/assets/js/553.17c08120.js"><link rel="prefetch" href="/assets/js/554.dba61578.js"><link rel="prefetch" href="/assets/js/555.4742121a.js"><link rel="prefetch" href="/assets/js/556.319b9173.js"><link rel="prefetch" href="/assets/js/557.1a0eb946.js"><link rel="prefetch" href="/assets/js/558.2f15be67.js"><link rel="prefetch" href="/assets/js/559.dcb32b4f.js"><link rel="prefetch" href="/assets/js/56.d5f7d141.js"><link rel="prefetch" href="/assets/js/560.946ead9f.js"><link rel="prefetch" href="/assets/js/561.92057b49.js"><link rel="prefetch" href="/assets/js/562.b47975d7.js"><link rel="prefetch" href="/assets/js/563.77c60c1f.js"><link rel="prefetch" href="/assets/js/564.0b027ba9.js"><link rel="prefetch" href="/assets/js/565.2fe498d2.js"><link rel="prefetch" href="/assets/js/566.9adf1b99.js"><link rel="prefetch" href="/assets/js/567.868fb8f9.js"><link rel="prefetch" href="/assets/js/568.19633edf.js"><link rel="prefetch" href="/assets/js/569.dd59e638.js"><link rel="prefetch" href="/assets/js/570.7d0fc6b0.js"><link rel="prefetch" href="/assets/js/571.13fc85ec.js"><link rel="prefetch" href="/assets/js/572.f2f4972b.js"><link rel="prefetch" href="/assets/js/573.95b697d4.js"><link rel="prefetch" href="/assets/js/574.be68ad2b.js"><link rel="prefetch" href="/assets/js/575.e234aaeb.js"><link rel="prefetch" href="/assets/js/576.02601981.js"><link rel="prefetch" href="/assets/js/577.445b0288.js"><link rel="prefetch" href="/assets/js/578.4d3bd8e1.js"><link rel="prefetch" href="/assets/js/579.82a258d2.js"><link rel="prefetch" href="/assets/js/58.6a6030a4.js"><link rel="prefetch" href="/assets/js/580.ac5ba225.js"><link rel="prefetch" href="/assets/js/581.e91836f9.js"><link rel="prefetch" href="/assets/js/582.7e04afc2.js"><link rel="prefetch" href="/assets/js/583.026687b8.js"><link rel="prefetch" href="/assets/js/584.2a645d2c.js"><link rel="prefetch" href="/assets/js/585.41018fa8.js"><link rel="prefetch" href="/assets/js/586.82b4eca0.js"><link rel="prefetch" href="/assets/js/587.216a1784.js"><link rel="prefetch" href="/assets/js/588.37f83fbc.js"><link rel="prefetch" href="/assets/js/589.51d0cd92.js"><link rel="prefetch" href="/assets/js/59.4c654ff4.js"><link rel="prefetch" href="/assets/js/590.d79c6131.js"><link rel="prefetch" href="/assets/js/591.ebbeac86.js"><link rel="prefetch" href="/assets/js/592.441e746e.js"><link rel="prefetch" href="/assets/js/593.4d9ed583.js"><link rel="prefetch" href="/assets/js/594.fa744788.js"><link rel="prefetch" href="/assets/js/595.41a8e546.js"><link rel="prefetch" href="/assets/js/596.3d55c7eb.js"><link rel="prefetch" href="/assets/js/597.b2975765.js"><link rel="prefetch" href="/assets/js/598.de415905.js"><link rel="prefetch" href="/assets/js/599.34d246dc.js"><link rel="prefetch" href="/assets/js/6.90a7863d.js"><link rel="prefetch" href="/assets/js/60.4c0b3191.js"><link rel="prefetch" href="/assets/js/600.c6de28b6.js"><link rel="prefetch" href="/assets/js/601.36c28ff0.js"><link rel="prefetch" href="/assets/js/602.df78ea8e.js"><link rel="prefetch" href="/assets/js/603.02d6dff1.js"><link rel="prefetch" href="/assets/js/604.505f6595.js"><link rel="prefetch" href="/assets/js/605.00349dab.js"><link rel="prefetch" href="/assets/js/606.73fd7eb5.js"><link rel="prefetch" href="/assets/js/607.b83af273.js"><link rel="prefetch" href="/assets/js/608.98991cca.js"><link rel="prefetch" href="/assets/js/609.28cefaed.js"><link rel="prefetch" href="/assets/js/61.358f0395.js"><link rel="prefetch" href="/assets/js/610.9d9d2509.js"><link rel="prefetch" href="/assets/js/611.013ec3a9.js"><link rel="prefetch" href="/assets/js/612.6f670900.js"><link rel="prefetch" href="/assets/js/613.ce04372b.js"><link rel="prefetch" href="/assets/js/614.c2a8ba17.js"><link rel="prefetch" href="/assets/js/615.63a19853.js"><link rel="prefetch" href="/assets/js/616.53daef00.js"><link rel="prefetch" href="/assets/js/617.8d0a4285.js"><link rel="prefetch" href="/assets/js/618.899be4b8.js"><link rel="prefetch" href="/assets/js/619.472b1437.js"><link rel="prefetch" href="/assets/js/62.b7db2408.js"><link rel="prefetch" href="/assets/js/620.3e38cdaa.js"><link rel="prefetch" href="/assets/js/621.f861a610.js"><link rel="prefetch" href="/assets/js/622.11e5a2ce.js"><link rel="prefetch" href="/assets/js/63.04bb0446.js"><link rel="prefetch" href="/assets/js/64.27cb02ae.js"><link rel="prefetch" href="/assets/js/65.5f994f46.js"><link rel="prefetch" href="/assets/js/66.239d0332.js"><link rel="prefetch" href="/assets/js/67.9cfdbb18.js"><link rel="prefetch" href="/assets/js/68.e58e3caf.js"><link rel="prefetch" href="/assets/js/69.ad9d07e1.js"><link rel="prefetch" href="/assets/js/7.b0a17725.js"><link rel="prefetch" href="/assets/js/70.adfe4d76.js"><link rel="prefetch" href="/assets/js/71.62c55f55.js"><link rel="prefetch" href="/assets/js/72.4f562164.js"><link rel="prefetch" href="/assets/js/73.25e7c235.js"><link rel="prefetch" href="/assets/js/74.02ea8cb2.js"><link rel="prefetch" href="/assets/js/75.51ce922f.js"><link rel="prefetch" href="/assets/js/76.5fb1dc6e.js"><link rel="prefetch" href="/assets/js/77.11aca8bd.js"><link rel="prefetch" href="/assets/js/78.0e5b66a0.js"><link rel="prefetch" href="/assets/js/79.b8c24d25.js"><link rel="prefetch" href="/assets/js/8.12dab63b.js"><link rel="prefetch" href="/assets/js/80.526c6d61.js"><link rel="prefetch" href="/assets/js/81.0ea7e6e3.js"><link rel="prefetch" href="/assets/js/82.57bfe4e9.js"><link rel="prefetch" href="/assets/js/83.56b81a0a.js"><link rel="prefetch" href="/assets/js/84.32a2e8e6.js"><link rel="prefetch" href="/assets/js/85.d288795b.js"><link rel="prefetch" href="/assets/js/86.57c98070.js"><link rel="prefetch" href="/assets/js/87.b96c354a.js"><link rel="prefetch" href="/assets/js/88.1cf21011.js"><link rel="prefetch" href="/assets/js/89.718434dd.js"><link rel="prefetch" href="/assets/js/9.443f6f2d.js"><link rel="prefetch" href="/assets/js/90.40bbf32c.js"><link rel="prefetch" href="/assets/js/91.474e00e7.js"><link rel="prefetch" href="/assets/js/92.07c131e1.js"><link rel="prefetch" href="/assets/js/93.e76bb418.js"><link rel="prefetch" href="/assets/js/94.21d5fd1b.js"><link rel="prefetch" href="/assets/js/95.e854c8ec.js"><link rel="prefetch" href="/assets/js/96.34d627e0.js"><link rel="prefetch" href="/assets/js/97.7a82c641.js"><link rel="prefetch" href="/assets/js/98.ca8330f6.js"><link rel="prefetch" href="/assets/js/99.4b92d0af.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">代码重工</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><p></p><div class="table-of-contents"><ul><li><a href="#_1、名称解释">1、名称解释</a></li><li><a href="#_2、工作机制">2、工作机制</a><ul><li><a href="#_1unsafe类">①Unsafe类</a></li><li><a href="#_2举例说明">②举例说明</a></li><li><a href="#_3配合-volatile">③配合 volatile</a></li></ul></li><li><a href="#_3、非阻塞同步">3、非阻塞同步</a></li><li><a href="#_4、cas-测试代码">4、CAS 测试代码</a></li><li><a href="#_5、aba-问题-了解">5、ABA 问题[了解]</a></li><li><a href="#_6、cas-和乐观锁">6、CAS 和乐观锁</a></li><li><a href="#_7、从-jmm-三大特性角度看原子类">7、从 JMM 三大特性角度看原子类</a></li></ul></div><p></p> <h1 id="第三节-cas-机制"><a href="#第三节-cas-机制" class="header-anchor">#</a> 第三节 CAS 机制</h1> <h2 id="_1、名称解释"><a href="#_1、名称解释" class="header-anchor">#</a> 1、名称解释</h2> <p>CAS：<span style="color:blue;font-weight:bold;">C</span>ompare <span style="color:blue;font-weight:bold;">A</span>nd <span style="color:blue;font-weight:bold;">S</span>wap 比较并交换。</p> <p>谁和谁比较？</p> <p>为什么比较完了才能交换？</p> <p>谁和谁交换？</p> <p>这东西有什么用？</p> <p>下面我们一一来解释。</p> <h2 id="_2、工作机制"><a href="#_2、工作机制" class="header-anchor">#</a> 2、工作机制</h2> <h3 id="_1unsafe类"><a href="#_1unsafe类" class="header-anchor">#</a> ①Unsafe类</h3> <h4 id="_1-引入"><a href="#_1-引入" class="header-anchor">#</a> [1]引入</h4> <p>原子类 AtomicInteger 中就大量用到了 CAS 机制，compareAndSet(int expect, int update); 方法就是其中的典型代表。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token function">compareAndSet</span><span class="token punctuation">(</span><span class="token keyword">int</span> expect<span class="token punctuation">,</span> <span class="token keyword">int</span> update<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> unsafe<span class="token punctuation">.</span><span class="token function">compareAndSwapInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> valueOffset<span class="token punctuation">,</span> expect<span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>从源码中我们可以看出，compareAndSet(int expect, int update); 方法里面其实是调用了 Unsafe 类的 compareAndSwapInt() 方法。</p> <p>Unsafe.compareAndSwapInt() 方法的源码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">native</span> <span class="token keyword">boolean</span> <span class="token function">compareAndSwapInt</span><span class="token punctuation">(</span><span class="token class-name">Object</span> var1<span class="token punctuation">,</span> <span class="token keyword">long</span> var2<span class="token punctuation">,</span> <span class="token keyword">int</span> var4<span class="token punctuation">,</span> <span class="token keyword">int</span> var5<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>很明显，这是一个本地方法。那 Unsafe 类是做什么的呢？</p> <h4 id="_2-介绍"><a href="#_2-介绍" class="header-anchor">#</a> [2]介绍</h4> <p>C/C++ 代码可以直接操作内存空间。而 Java 程序屏蔽了对内存空间的直接访问，简化了代码复杂度，提高了安全性。但是凡事都有例外，Unsafe 类在一定程度上可以看作是一个可以用来操作内存空间的 Java 类。</p> <p>正是因为使用 Unsafe 类可以直接操作内存，所以它的名字叫 Unsafe，也就是『<span style="color:red;font-weight:bold;">危险</span>』的意思——常规业务功能的开发中不能直接操作内存，这是非常危险的操作。</p> <p>所以这里的 Unsafe 并不是指线程不安全。我们这里关注的是它提供的 CAS 方法。</p> <h3 id="_2举例说明"><a href="#_2举例说明" class="header-anchor">#</a> ②举例说明</h3> <h4 id="_1-内存初始状态"><a href="#_1-内存初始状态" class="header-anchor">#</a> [1]内存初始状态</h4> <ul><li>内存空间地址：0x00FA</li> <li>内存空间数据值：5</li></ul> <p><img src="data:image/png;base64,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" alt="images_cas"></p> <h4 id="_2-尝试修改成功"><a href="#_2-尝试修改成功" class="header-anchor">#</a> [2]尝试修改成功</h4> <p>CAS 机制修改数据必须提供内存空间地址以找到要修改的数据。提供旧值用来和内存实际值进行比较。提供新值作为修改后的值。</p> <ul><li>内存空间地址：0x00FA</li> <li>内存空间数据值：<span style="color:blue;font-weight:bold;">5</span></li> <li>修改者提供的旧值（expected value）：<span style="color:blue;font-weight:bold;">5</span></li> <li>修改者提供的新值（update value）：10</li></ul> <p><img src="/assets/img/img002.dc1ed943.png" alt="images_cas"></p> <h4 id="_3-尝试修改失败"><a href="#_3-尝试修改失败" class="header-anchor">#</a> [3]尝试修改失败</h4> <p>如果修改者提供的旧值与内存实际值不相等，那么 CAS 机制将禁止修改数据。</p> <ul><li>内存空间地址：0x00FA</li> <li>内存空间数据值：<span style="color:blue;font-weight:bold;">7</span></li> <li>修改者提供的旧值（expected value）：<span style="color:red;font-weight:bold;">5</span></li> <li>修改者提供的新值（update value）：10</li></ul> <p><img src="/assets/img/img003.bcbddf8b.png" alt="images_cas"></p> <h4 id="_4-自旋"><a href="#_4-自旋" class="header-anchor">#</a> [4]自旋</h4> <p>修改被禁止，但操作不会结束。CAS 机制会引导修改者读取当前内存值，然后再次尝试修改。</p> <ul><li>读取内存值作为旧值：</li></ul> <p><img src="data:image/png;base64,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" alt="images_cas"></p> <ul><li>再次尝试修改：</li></ul> <p><img src="/assets/img/img005.88912205.png" alt="images_cas"></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>注意：读取内存值之后的第二次尝试修改也不一定修改成功。自旋可能会执行多次。</p> <p><img src="/assets/img/img007.2a9bb99e.png" alt="images_cas"></p></div> <h3 id="_3配合-volatile"><a href="#_3配合-volatile" class="header-anchor">#</a> ③配合 volatile</h3> <p>思考一个问题：我们前面提到的内存空间是工作内存还是主内存呢？很明显，应该是主内存。如果是在工作内存中一个线程内部自己和自己玩也就没必要整这些了，所以这里的内存空间指的是主内存。</p> <p>但是每个线程修改数据又都是在工作内存完成的，修改完成执行 store 指令才会同步到主内存，执行 write 指令才会设置到对应变量中。</p> <p>所以 CAS 操作通常都会配合 volatile 关键字：将 CAS 要操作的变量使用 volatile 修饰，实现可见性效果。</p> <p>这一点我们看 AtomicInteger 类就可以发现：</p> <p><img src="/assets/img/img006.b6e7197b.png" alt="images_cas"></p> <p>所以 AtomicInteger 等原子类可以看成是 CAS 机制配合 volatile 实现非阻塞同步的经典案例。</p> <h2 id="_3、非阻塞同步"><a href="#_3、非阻塞同步" class="header-anchor">#</a> 3、非阻塞同步</h2> <p>前面我们比较过 AtomicInteger 和 synchronized 两种方案实现原子性操作的性能差距，AtomicInteger 方式对比 synchronized 方式性能优势非常明显。</p> <p>那 AtomicInteger 是如何做到既保证原子性（同步），又能够达到非常高的效率呢？</p> <p>原因是：</p> <ul><li>使用 CAS 机制修改数据不需要对代码块加同步锁，各线程通过自旋的方式不断尝试修改，<span style="color:blue;font-weight:bold;">线程不会被阻塞</span>。</li> <li>配合 volatile 关键字使各个线程直接操作主内存避免了数据不一致。</li></ul> <p>所以 CAS 配合 volatile 不需要阻塞线程就能够实现同步效果，性能自然就会比 synchronized 更好。我们把这种机制称为：<span style="color:blue;font-weight:bold;">非阻塞同步</span>。</p> <p>当然，这种机制也并不能完全取代同步锁。因为 CAS 针对的是内存中的一个具体数据，无法对一段代码实现同步效果。</p> <h2 id="_4、cas-测试代码"><a href="#_4、cas-测试代码" class="header-anchor">#</a> 4、CAS 测试代码</h2> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 1、创建 Integer 的原子类对象，设定初始值为 5</span>
<span class="token class-name">AtomicInteger</span> atomicInteger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2、尝试修改</span>
<span class="token comment">// ①基于旧值 5 修改</span>
<span class="token comment">// updateResult = true 当前值 = 666</span>
<span class="token keyword">boolean</span> updateResult <span class="token operator">=</span> atomicInteger<span class="token punctuation">.</span><span class="token function">compareAndSet</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">666</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;updateResult = &quot;</span> <span class="token operator">+</span> updateResult <span class="token operator">+</span> <span class="token string">&quot; 当前值 = &quot;</span> <span class="token operator">+</span> atomicInteger<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ②基于旧值 5 修改</span>
<span class="token comment">// updateResult = false 当前值 = 666</span>
updateResult <span class="token operator">=</span> atomicInteger<span class="token punctuation">.</span><span class="token function">compareAndSet</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">777</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;updateResult = &quot;</span> <span class="token operator">+</span> updateResult <span class="token operator">+</span> <span class="token string">&quot; 当前值 = &quot;</span> <span class="token operator">+</span> atomicInteger<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ③基于旧值 666 修改</span>
<span class="token comment">// updateResult = true 当前值 = 888</span>
updateResult <span class="token operator">=</span> atomicInteger<span class="token punctuation">.</span><span class="token function">compareAndSet</span><span class="token punctuation">(</span><span class="token number">666</span><span class="token punctuation">,</span> <span class="token number">888</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;updateResult = &quot;</span> <span class="token operator">+</span> updateResult <span class="token operator">+</span> <span class="token string">&quot; 当前值 = &quot;</span> <span class="token operator">+</span> atomicInteger<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>打印结果：</p> <blockquote><p>修改结果：true 当前值：666<br>
修改结果：false 当前值：666<br>
修改结果：true 当前值：777</p></blockquote> <h2 id="_5、aba-问题-了解"><a href="#_5、aba-问题-了解" class="header-anchor">#</a> 5、ABA 问题[了解]</h2> <p><img src="/assets/img/img026.2068dc10.png" alt="images_cas"></p> <p>ABA 问题本质：一个原本不允许的操作，因为数据发生了变化，又允许操作了。但是 ABA 问题虽然存在，但如果只修改一个值在简单计算的场景下应该是没有问题的。当然如果确实涉及到复杂的业务逻辑还是要注意一下。</p> <h2 id="_6、cas-和乐观锁"><a href="#_6、cas-和乐观锁" class="header-anchor">#</a> 6、CAS 和乐观锁</h2> <p>CAS 机制可以看做是乐观锁理念的一种具体实现。但是又<span style="color:blue;font-weight:bold;">不完整</span>。因为乐观锁的具体实现通常是需要维护版本号的，但是 CAS 机制中并不包含版本号——如果有版本号辅助就不会有 ABA 问题了。</p> <h2 id="_7、从-jmm-三大特性角度看原子类"><a href="#_7、从-jmm-三大特性角度看原子类" class="header-anchor">#</a> 7、从 JMM 三大特性角度看原子类</h2> <p>前面我们看到 AtomicInteger 类是 CAS 机制和 volatile 关键字的整合，所以它的缓存一致性效果是二者的综合：</p> <ul><li>原子性：满足。一方面前面我们已经测试过了，还有就是——你看人家这个类叫什么名字啊喂！</li> <li>有序性：满足。由 volatile 关键字保证有序性。</li> <li>可见性：满足。由 volatile 关键字保证可见性。</li></ul> <p>结论：单纯使用使用原子类执行并发操作时，<span style="color:blue;font-weight:bold;">能够保证线程安全</span>，而且<span style="color:blue;font-weight:bold;">性能很好</span>。</p> <p><a href="/pro017-JUC/lecture/chapter05/verse02.html">上一节</a> <a href="/pro017-JUC/lecture/chapter05/index.html">回目录</a> <a href="/pro017-JUC/lecture/chapter05/verse04.html">下一节</a></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.3e0017e1.js" defer></script><script src="/assets/js/3.20041f1c.js" defer></script><script src="/assets/js/57.08a9b0c8.js" defer></script>
  </body>
</html>
